var cl=Object.defineProperty;var nt=Object.getOwnPropertySymbols;var dl=Object.prototype.hasOwnProperty,pl=Object.prototype.propertyIsEnumerable;var Xe=(l,e,t)=>e in l?cl(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t,ue=(l,e)=>{for(var t in e||(e={}))dl.call(e,t)&&Xe(l,t,e[t]);if(nt)for(var t of nt(e))pl.call(e,t)&&Xe(l,t,e[t]);return l};var ot=(l,e,t)=>(Xe(l,typeof e!="symbol"?e+"":e,t),t);import{D as _l,S as ne,i as oe,s as ie,G as Qe,C as je,c as F,m as N,n as le,t as R,a as K,d as X,b as Q,e as he,f as Y,g as ce,h as de,j as D,k as qe,l as ze,o as $e,u as Re,p as et,q as Ft,R as hl,r as De,T as gl,v as it,w as st,x as S,y as te,z as C,A as fe,B as p,E as q,F as J,H as Ie,I as tt,J as V,K as j,L as z,M as Nt,N as we,O as ve,P as Ke,Q as _e,U as Ue,V as me,W as pe,X as Pe,Y as ml,Z as bl,_ as Xt,$ as qt,a0 as Vt,a1 as yl,a2 as kl,a3 as Ye,a4 as Al,a5 as wl,a6 as vl,a7 as Cl,a8 as Sl,a9 as Il}from"./vendor.6d18f426.js";const Tl=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}};Tl();class El extends _l{constructor(){super("mapsdb");ot(this,"mapSaves");this.version(2).stores({mapSaves:"++id, mapString, previewBase64"})}}const We=new El;function Oe(l,e,t="flatTop",n=0,o=0){return t=="pointyTop"?[n,o-e/2,n+l/2,o-e*.25,n+l/2,o+e*.25,n,o+e/2,n-l/2,o+e*.25,n-l/2,o-e*.25]:[n-l*.25,o-e/2,n+l*.25,o-e/2,n+l/2,o,n+l*.25,o+e/2,n-l*.25,o+e/2,n-l/2,o]}function Bl(l,e="flatTop",t=0,n=0){let o,r;return e=="pointyTop"?(r=l*2,o=Math.cos(Math.PI/6)*l*2):(o=l*2,r=l/Math.tan(Math.PI/6)),Oe(o,r,e,t,n)}function Ve(l,e,t){return l.toString()+":"+e.toString()+":"+t.toString()}function rt(l,e){return{q:l,r:e,s:-l-e}}function at(l){let e=Math.round(l.q),t=Math.round(l.r),n=Math.round(l.s),o=Math.abs(e-l.q),r=Math.abs(t-l.r),i=Math.abs(n-l.s);return o>r&&o>i?e=-t-n:r>i?t=-e-n:n=-e-t,{q:e,r:t,s:n}}function xe(l,e,t,n,o){if(t=="flatTop"){let r=l/(n*.75),i=(2*e/o-r)/2;return at(rt(r,i))}else if(t=="pointyTop"){let r=e/(o*.75),i=(2*l/n-r)/2;return at(rt(i,r))}}function He(l,e,t,n,o,r){if(n=="flatTop"){let i=l*o*.75,a=e*r/2-t*r/2;return{x:i,y:a}}else if(n=="pointyTop")return{x:l*o/2-t*o/2,y:e*r*.75}}function ut(l){let e,t;return e=new Qe({props:{instance:l[3],draw:Pl}}),{c(){F(e.$$.fragment)},m(n,o){N(e,n,o),t=!0},p:le,i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Hl(l){let e,t,n,o,r,i;e=new Qe({props:{instance:l[1],draw:Ul}}),n=new je({props:{instance:l[2]}});let a=l[0].grid.shown&&ut(l);return{c(){F(e.$$.fragment),t=Q(),F(n.$$.fragment),o=Q(),a&&a.c(),r=he()},m(s,u){N(e,s,u),Y(s,t,u),N(n,s,u),Y(s,o,u),a&&a.m(s,u),Y(s,r,u),i=!0},p(s,[u]){s[0].grid.shown?a?(a.p(s,u),u&1&&R(a,1)):(a=ut(s),a.c(),R(a,1),a.m(r.parentNode,r)):a&&(ce(),K(a,1,1,()=>{a=null}),de())},i(s){i||(R(e.$$.fragment,s),R(n.$$.fragment,s),R(a),i=!0)},o(s){K(e.$$.fragment,s),K(n.$$.fragment,s),K(a),i=!1},d(s){X(e,s),s&&D(t),X(n,s),s&&D(o),a&&a.d(s),s&&D(r)}}}const Ul=l=>{},Pl=l=>{};function Ql(l,e,t){let n=new qe,o=new ze,r=new qe,i={},{pan:a}=e,{controls:s}=e,{L:u}=e,{tfield:c}=e,{data_terrain:h}=e;function k(f){if(c.hexWidth<c.hexHeight){let y=c.hexWidth*f.percentOfTotalHex/100/f.texWidth;return{x:y,y}}else{let y=c.hexHeight*f.percentOfTotalHex/100/f.texHeight;return{x:y,y}}}function b(){r.clear(),r.lineStyle(c.grid.thickness,c.grid.stroke),Object.keys(c.hexes).forEach(f=>{let y=c.hexes[f],H=He(y.q,y.r,y.s,c.orientation,c.hexWidth,c.hexHeight);r.drawPolygon(Oe(c.hexWidth,c.hexHeight,c.orientation,H.x,H.y))})}function E(){n.clear(),Object.keys(c.hexes).forEach(f=>{g(f)}),b()}function g(f){let y=c.hexes[f],H=He(y.q,y.r,y.s,c.orientation,c.hexWidth,c.hexHeight);if(n.beginFill(y.bgColor),n.drawPolygon(Oe(c.hexWidth,c.hexHeight,c.orientation,H.x,H.y)),n.endFill(),y.symbol){i[f]&&(o.removeChild(i[f]),i[f].destroy(),delete i[f]);let T=new $e;T.texture=u.resources[y.symbol.texId].texture;let v=He(y.q,y.r,y.s,c.orientation,c.hexWidth,c.hexHeight);T.position.set(v.x,v.y),T.anchor.set(.5),T.tint=y.symbol.color,T.scale=k(y.symbol),o.addChild(T),i[f]=T}else i[f]&&(o.removeChild(i[f]),i[f].destroy(),delete i[f])}function m(){if(t(4,h),s.mouseDown[0]){let f=a.worldX,y=a.worldY,H=xe(f,y,c.orientation,c.hexWidth,c.hexHeight),T=Ve(H.q,H.r,H.s);t(0,c.hexes[T].bgColor=h.bgColor,c),t(0,c.hexes[T].symbol=h.symbolData?ue({},h.symbolData):null,c),g(T)}}function d(){let f=xe(a.worldX,a.worldY,c.orientation,c.hexWidth,c.hexHeight),y=Ve(f.q,f.r,f.s);t(0,c.hexes[y].bgColor=c.blankHexColor,c),t(0,c.hexes[y].symbol=null,c),g(y)}return E(),b(),l.$$set=f=>{"pan"in f&&t(5,a=f.pan),"controls"in f&&t(6,s=f.controls),"L"in f&&t(7,u=f.L),"tfield"in f&&t(0,c=f.tfield),"data_terrain"in f&&t(4,h=f.data_terrain)},[c,n,o,r,h,a,s,u,E,m,d]}class Rl extends ne{constructor(e){super();oe(this,e,Ql,Hl,ie,{pan:5,controls:6,L:7,tfield:0,data_terrain:4,renderAllHexes:8,placeTerrain:9,erase:10})}get renderAllHexes(){return this.$$.ctx[8]}get placeTerrain(){return this.$$.ctx[9]}get erase(){return this.$$.ctx[10]}}function ft(l,e,t){const n=l.slice();return n[13]=e[t],n}function ct(l,e){let t,n,o;function r(...a){return e[9](e[13],...a)}function i(...a){return e[10](e[13],...a)}return n=new Ft({props:{texture:e[1].resources[e[13].texId].texture,x:e[13].x,y:e[13].y,tint:e[13].color,anchor:{x:.5,y:.5},scale:{x:e[13].scale,y:e[13].scale},interactive:e[2]=="eraser"}}),n.$on("pointerdown",r),n.$on("pointerover",i),{key:l,first:null,c(){t=he(),F(n.$$.fragment),this.first=t},m(a,s){Y(a,t,s),N(n,a,s),o=!0},p(a,s){e=a;const u={};s&3&&(u.texture=e[1].resources[e[13].texId].texture),s&1&&(u.x=e[13].x),s&1&&(u.y=e[13].y),s&1&&(u.tint=e[13].color),s&1&&(u.scale={x:e[13].scale,y:e[13].scale}),s&4&&(u.interactive=e[2]=="eraser"),n.$set(u)},i(a){o||(R(n.$$.fragment,a),o=!0)},o(a){K(n.$$.fragment,a),o=!1},d(a){a&&D(t),X(n,a)}}}function Ml(l){let e=[],t=new Map,n,o,r=l[0];const i=a=>a[13].id;for(let a=0;a<r.length;a+=1){let s=ft(l,r,a),u=i(s);t.set(u,e[a]=ct(u,s))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he()},m(a,s){for(let u=0;u<e.length;u+=1)e[u].m(a,s);Y(a,n,s),o=!0},p(a,[s]){s&31&&(r=a[0],ce(),e=Re(e,s,i,1,a,r,t,n.parentNode,et,ct,n,ft),de())},i(a){if(!o){for(let s=0;s<r.length;s+=1)R(e[s]);o=!0}},o(a){for(let s=0;s<e.length;s+=1)K(e[s]);o=!1},d(a){for(let s=0;s<e.length;s+=1)e[s].d(a);a&&D(n)}}}function Ll(l,e,t){let{icons:n=[]}=e,{L:o}=e,{pan:r}=e,{tfield:i}=e,{selectedTool:a}=e,{controls:s}=e,{data_icon:u}=e,c=0;n.forEach(m=>c=Math.max(c,m.id)),c++;function h(){let m;return i.hexWidth<i.hexHeight?m=i.hexWidth*(u.pHex/100)/o.resources[u.texId].texture.width:m=i.hexHeight*(u.pHex/100)/o.resources[u.texId].texture.height,m}function k(){let m=r.worldX,d=r.worldY;if(u.snapToHex){let f=xe(r.worldX,r.worldY,i.orientation,i.hexWidth,i.hexHeight),y=He(f.q,f.r,f.s,i.orientation,i.hexWidth,i.hexHeight);m=y.x,d=y.y}n.push({x:m,y:d,color:u.color,scale:h(),id:c,texId:u.texId}),c++,t(0,n)}function b(m){let d=n.indexOf(m);n.splice(d,1),t(0,n)}const E=(m,d)=>{b(m)},g=(m,d)=>{s.mouseDown[0]&&b(m)};return l.$$set=m=>{"icons"in m&&t(0,n=m.icons),"L"in m&&t(1,o=m.L),"pan"in m&&t(5,r=m.pan),"tfield"in m&&t(6,i=m.tfield),"selectedTool"in m&&t(2,a=m.selectedTool),"controls"in m&&t(3,s=m.controls),"data_icon"in m&&t(7,u=m.data_icon)},[n,o,a,s,b,r,i,u,k,E,g]}class Jl extends ne{constructor(e){super();oe(this,e,Ll,Ml,ie,{icons:0,L:1,pan:5,tfield:6,selectedTool:2,controls:3,data_icon:7,newIcon:8})}get newIcon(){return this.$$.ctx[8]}}function dt(l,e,t){const n=l.slice();return n[20]=e[t],n}function Yl(l){let e,t,n;function o(...r){return l[13](l[20],...r)}return e=new Qe({props:{draw:o}}),{c(){F(e.$$.fragment),t=Q()},m(r,i){N(e,r,i),Y(r,t,i),n=!0},p(r,i){l=r;const a={};i&11&&(a.draw=o),e.$set(a)},i(r){n||(R(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){X(e,r),r&&D(t)}}}function pt(l,e){let t,n,o;function r(){return e[14](e[20])}return n=new je({props:{interactive:e[2]=="path"&&!e[0].selectedPath,hitArea:e[4](e[20]),$$slots:{default:[Yl]},$$scope:{ctx:e}}}),n.$on("pointerover",r),n.$on("pointerout",e[15]),{key:l,first:null,c(){t=he(),F(n.$$.fragment),this.first=t},m(i,a){Y(i,t,a),N(n,i,a),o=!0},p(i,a){e=i;const s={};a&5&&(s.interactive=e[2]=="path"&&!e[0].selectedPath),a&2&&(s.hitArea=e[4](e[20])),a&8388619&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(i){o||(R(n.$$.fragment,i),o=!0)},o(i){K(n.$$.fragment,i),o=!1},d(i){i&&D(t),X(n,i)}}}function Dl(l){let e=[],t=new Map,n,o,r=l[1];const i=a=>a[20].id;for(let a=0;a<r.length;a+=1){let s=dt(l,r,a),u=i(s);t.set(u,e[a]=pt(u,s))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=he()},m(a,s){for(let u=0;u<e.length;u+=1)e[u].m(a,s);Y(a,n,s),o=!0},p(a,[s]){s&127&&(r=a[1],ce(),e=Re(e,s,i,1,a,r,t,n.parentNode,et,pt,n,dt),de())},i(a){if(!o){for(let s=0;s<r.length;s+=1)R(e[s]);o=!0}},o(a){for(let s=0;s<e.length;s+=1)K(e[s]);o=!1},d(a){for(let s=0;s<e.length;s+=1)e[s].d(a);a&&D(n)}}}function Kl(l,e,t){let{controls:n}=e,{pan:o}=e,{selectedTool:r}=e,{tfield:i}=e,{data_path:a}=e,{paths:s=[]}=e,u=null,c=0;s.forEach(w=>c=Math.max(c,w.id)),c++;function h(w,I,U){w.points=[...w.points,I,U],t(1,s)}function k(w){if(n.mouseDown[0])if(a.selectedPath){let I=o.worldX,U=o.worldY;if(a.snap){let P=g();I=P.x,U=P.y}h(a.selectedPath,I,U)}else u?(t(0,a.selectedPath=s[s.indexOf(u)],a),t(0,a.colorString=De(a.selectedPath.style.color),a),t(0,a.style=ue({},a.selectedPath.style),a),t(3,u=null)):m()}function b(w){w.points.pop(),w.points.pop(),t(1,s),w.points.length==0&&E(w)}function E(w){t(0,a.selectedPath=null,a);let I=s.indexOf(w);s.splice(I,1),t(1,s)}function g(){let w=i.hexWidth,I=i.hexHeight,U=xe(o.worldX,o.worldY,i.orientation,i.hexWidth,i.hexHeight),P=He(U.q,U.r,U.s,i.orientation,i.hexWidth,i.hexHeight),O={x:1/0,y:1/0},M=1/0,A;return i.orientation=="flatTop"?A=[P,{x:P.x+w/4,y:P.y-I/2},{x:P.x+w/2,y:P.y},{x:P.x+w/4,y:P.y+I/2},{x:P.x-w/4,y:P.y+I/2},{x:P.x-w/2,y:P.y},{x:P.x-w/4,y:P.y-I/2}]:i.orientation=="pointyTop"&&(A=[P,{x:P.x,y:P.y-I/2},{x:P.x+w/2,y:P.y-I/4},{x:P.x+w/2,y:P.y+I/4},{x:P.x,y:P.y},{x:P.x-w/2,y:P.y+I/4},{x:P.x-w/2,y:P.y+I/4}]),A.forEach(_=>{let L=Math.sqrt((_.x-o.worldX)**2+(_.y-o.worldY)**2);L<M&&(O=_,M=L)}),O}function m(){let w=o.worldX,I=o.worldY;if(a.snap){let U=g();w=U.x,I=U.y}s.push({id:c,style:ue({},a.style),points:[w,I]}),t(1,s),c++,t(0,a.selectedPath=s[s.length-1],a)}function d(w){let I=1/0,U=-1/0,P=1/0,O=-1/0;for(let _=0;_<w.points.length;_+=2){let L=w.points[_],G=w.points[_+1];L<I&&(I=L),L>U&&(U=L),P=Math.min(P,G),O=Math.max(O,G)}let M=5;return new hl(I-M,P-M,U-I+M*2,O-P+M*2)}const f={width:1,color:5592405},y={width:2,color:3355443},H=(w,I)=>{I.clear(),I.lineStyle(w.style),I.moveTo(w.points[0],w.points[1]);for(let U=0;U<w.points.length;U+=2)I.lineTo(w.points[U],w.points[U+1]);if(a.selectedPath==w){I.lineStyle(y);for(let U=0;U<w.points.length;U+=2)I.drawCircle(w.points[U],w.points[U+1],4)}else if(u==w){I.lineStyle(f);for(let U=0;U<w.points.length;U+=2)I.drawCircle(w.points[U],w.points[U+1],3)}},T=w=>{t(3,u=w)},v=()=>{t(3,u=null)};return l.$$set=w=>{"controls"in w&&t(7,n=w.controls),"pan"in w&&t(8,o=w.pan),"selectedTool"in w&&t(2,r=w.selectedTool),"tfield"in w&&t(9,i=w.tfield),"data_path"in w&&t(0,a=w.data_path),"paths"in w&&t(1,s=w.paths)},[a,s,r,u,d,f,y,n,o,i,k,b,E,H,T,v]}class Wl extends ne{constructor(e){super();oe(this,e,Kl,Dl,ie,{controls:7,pan:8,selectedTool:2,tfield:9,data_path:0,paths:1,pointerdown:10,removeLastPoint:11,deletePath:12})}get pointerdown(){return this.$$.ctx[10]}get removeLastPoint(){return this.$$.ctx[11]}get deletePath(){return this.$$.ctx[12]}}function _t(l,e,t){const n=l.slice();return n[19]=e[t],n}function ht(l,e){let t,n,o;function r(...i){return e[10](e[19],...i)}return n=new gl({props:{x:e[19].x,y:e[19].y,style:e[19].style,text:e[19].text,height:e[4](e[19]),width:e[3](e[19]),interactive:!0}}),n.$on("pointerover",r),n.$on("pointerout",e[11]),{key:l,first:null,c(){t=he(),F(n.$$.fragment),this.first=t},m(i,a){Y(i,t,a),N(n,i,a),o=!0},p(i,a){e=i;const s={};a&2&&(s.x=e[19].x),a&2&&(s.y=e[19].y),a&2&&(s.style=e[19].style),a&2&&(s.text=e[19].text),a&2&&(s.height=e[4](e[19])),a&2&&(s.width=e[3](e[19])),n.$set(s)},i(i){o||(R(n.$$.fragment,i),o=!0)},o(i){K(n.$$.fragment,i),o=!1},d(i){i&&D(t),X(n,i)}}}function Ol(l){let e=[],t=new Map,n,o,r,i=l[1];const a=s=>s[19].id;for(let s=0;s<i.length;s+=1){let u=_t(l,i,s),c=a(u);t.set(c,e[s]=ht(c,u))}return o=new Qe({props:{draw:l[12]}}),{c(){for(let s=0;s<e.length;s+=1)e[s].c();n=Q(),F(o.$$.fragment)},m(s,u){for(let c=0;c<e.length;c+=1)e[c].m(s,u);Y(s,n,u),N(o,s,u),r=!0},p(s,[u]){u&30&&(i=s[1],ce(),e=Re(e,u,a,1,s,i,t,n.parentNode,et,ht,n,_t),de());const c={};u&5&&(c.draw=s[12]),o.$set(c)},i(s){if(!r){for(let u=0;u<i.length;u+=1)R(e[u]);R(o.$$.fragment,s),r=!0}},o(s){for(let u=0;u<e.length;u+=1)K(e[u]);K(o.$$.fragment,s),r=!1},d(s){for(let u=0;u<e.length;u+=1)e[u].d(s);s&&D(n),X(o,s)}}}function xl(l,e,t){let{pan:n}=e,{data_text:o}=e,r,i,a,s,{texts:u=[]}=e,c=0;u.forEach(v=>c=Math.max(c,v.id)),c++;function h(){o.selectedText&&r?(k(),setTimeout(()=>{o.editorRef.focus()},10)):o.selectedText?(o.selectedText.text==""&&m(o.selectedText),t(0,o.selectedText=null,o)):r?k():g()}function k(){t(0,o.style=ue({},r.style),o),t(0,o.selectedText=r,o),i=o.selectedText,a=n.worldX-r.x,s=n.worldY-r.y}function b(){i=null}function E(){i&&(i.x=n.worldX-a,i.y=n.worldY-s,t(1,u),t(0,o))}function g(){u.push({id:c,text:"",style:ue({},o.style),x:n.worldX,y:n.worldY}),c++,t(1,u),t(0,o),t(0,o.selectedText=u[u.length-1],o)}function m(v){v==o.selectedText&&t(0,o.selectedText=null,o);let w=u.indexOf(v);u.splice(w,1),t(1,u),t(0,o)}function d(v){return it.measureText(v.text,new st(v.style)).width}function f(v){return it.measureText(v.text,new st(v.style)).height}const y=(v,w)=>t(2,r=v),H=v=>t(2,r=null),T=v=>{v.clear(),o.selectedText&&(v.lineStyle(4,3355443),v.drawRect(o.selectedText.x-5,o.selectedText.y-5,d(o.selectedText)+10,f(o.selectedText)+10)),r&&r!=o.selectedText&&(v.lineStyle(2,5592405),v.drawRect(r.x-4,r.y-4,d(r)+8,f(r)+8))};return l.$$set=v=>{"pan"in v&&t(5,n=v.pan),"data_text"in v&&t(0,o=v.data_text),"texts"in v&&t(1,u=v.texts)},l.$$.update=()=>{l.$$.dirty&3&&(o.selectedText&&t(0,o.selectedText.style=ue({},o.style),o),t(1,u),t(0,o))},[o,u,r,d,f,n,h,b,E,m,y,H,T]}class Fl extends ne{constructor(e){super();oe(this,e,xl,Ol,ie,{pan:5,data_text:0,texts:1,pointerdown:6,pointerup:7,pointermove:8,deleteText:9})}get pointerdown(){return this.$$.ctx[6]}get pointerup(){return this.$$.ctx[7]}get pointermove(){return this.$$.ctx[8]}get deleteText(){return this.$$.ctx[9]}}function Nl(l){let e,t,n,o,r,i,a;return{c(){e=S("main"),t=S("div"),n=S("input"),o=Q(),r=te(l[3]),C(n,"type","color"),C(n,"class","svelte-1rvadqh"),fe(t,"--bg-color",l[0]),fe(t,"width",l[1]+"px"),fe(t,"height",l[2]+"px"),C(t,"class","svelte-1rvadqh"),C(e,"class","svelte-1rvadqh")},m(s,u){Y(s,e,u),p(e,t),p(t,n),q(n,l[0]),p(e,o),p(e,r),i||(a=J(n,"input",l[4]),i=!0)},p(s,[u]){u&1&&q(n,s[0]),u&1&&fe(t,"--bg-color",s[0]),u&2&&fe(t,"width",s[1]+"px"),u&4&&fe(t,"height",s[2]+"px"),u&8&&Ie(r,s[3])},i:le,o:le,d(s){s&&D(e),i=!1,a()}}}function Xl(l,e,t){let{value:n="#000000"}=e,{width:o=25}=e,{height:r=25}=e,{label:i=""}=e;function a(){n=this.value,t(0,n)}return l.$$set=s=>{"value"in s&&t(0,n=s.value),"width"in s&&t(1,o=s.width),"height"in s&&t(2,r=s.height),"label"in s&&t(3,i=s.label)},[n,o,r,i,a]}class Ge extends ne{constructor(e){super();oe(this,e,Xl,Nl,ie,{value:0,width:1,height:2,label:3})}}function ql(l){let e,t,n,o,r,i,a;return{c(){e=S("main"),t=S("div"),n=S("input"),o=Q(),r=te(l[2]),C(n,"type","color"),C(n,"class","svelte-1rvadqh"),fe(t,"--bg-color",l[3]),fe(t,"width",l[0]+"px"),fe(t,"height",l[1]+"px"),C(t,"class","svelte-1rvadqh"),C(e,"class","svelte-1rvadqh")},m(s,u){Y(s,e,u),p(e,t),p(t,n),q(n,l[3]),p(e,o),p(e,r),i||(a=J(n,"input",l[6]),i=!0)},p(s,[u]){u&8&&q(n,s[3]),u&8&&fe(t,"--bg-color",s[3]),u&1&&fe(t,"width",s[0]+"px"),u&2&&fe(t,"height",s[1]+"px"),u&4&&Ie(r,s[2])},i:le,o:le,d(s){s&&D(e),i=!1,a()}}}function Vl(l,e,t){let{value:n=0}=e,o=De(n),r=o,{width:i=25}=e,{height:a=25}=e,{label:s=""}=e;function u(){r=this.value,t(3,r),t(5,o),t(4,n)}return l.$$set=c=>{"value"in c&&t(4,n=c.value),"width"in c&&t(0,i=c.width),"height"in c&&t(1,a=c.height),"label"in c&&t(2,s=c.label)},l.$$.update=()=>{l.$$.dirty&56&&(r!=o?t(4,n=tt(r)):t(3,r=De(n)),t(5,o=r))},[i,a,s,r,n,o,u]}class lt extends ne{constructor(e){super();oe(this,e,Vl,ql,ie,{value:4,width:0,height:1,label:2})}}function gt(l,e,t){const n=l.slice();return n[15]=e[t],n}function mt(l,e,t){const n=l.slice();return n[18]=e[t],n}function bt(l){let e,t,n;function o(i){l[8](i)}let r={label:"Symbol"};return l[0].symbolData.color!==void 0&&(r.value=l[0].symbolData.color),e=new lt({props:r}),V.push(()=>j(e,"value",o)),{c(){F(e.$$.fragment)},m(i,a){N(e,i,a),n=!0},p(i,a){const s={};!t&&a&1&&(t=!0,s.value=i[0].symbolData.color,z(()=>t=!1)),e.$set(s)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){X(e,i)}}}function yt(l,e){let t,n=e[18].display+"",o,r,i;function a(){return e[9](e[18])}return{key:l,first:null,c(){t=S("button"),o=te(n),this.first=t},m(s,u){Y(s,t,u),p(t,o),r||(i=J(t,"click",a),r=!0)},p(s,u){e=s,u&2&&n!==(n=e[18].display+"")&&Ie(o,n)},d(s){s&&D(t),r=!1,i()}}}function kt(l){let e=[],t=new Map,n,o=l[1][l[15]];const r=i=>i[18].id;for(let i=0;i<o.length;i+=1){let a=mt(l,o,i),s=r(a);t.set(s,e[i]=yt(s,a))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();n=he()},m(i,a){for(let s=0;s<e.length;s+=1)e[s].m(i,a);Y(i,n,a)},p(i,a){a&10&&(o=i[1][i[15]],e=Re(e,a,r,1,i,o,t,n.parentNode,Nt,yt,n,mt))},d(i){for(let a=0;a<e.length;a+=1)e[a].d(i);i&&D(n)}}}function Gl(l){let e,t,n,o,r,i,a,s,u,c,h,k;function b(f){l[7](f)}let E={label:"Background"};l[0].bgColor!==void 0&&(E.value=l[0].bgColor),a=new lt({props:E}),V.push(()=>j(a,"value",b));let g=l[0].symbolData&&bt(l),m=Object.keys(l[1]),d=[];for(let f=0;f<m.length;f+=1)d[f]=kt(gt(l,m,f));return{c(){e=S("div"),t=S("div"),n=S("div"),o=S("img"),i=Q(),F(a.$$.fragment),u=Q(),g&&g.c(),c=Q(),h=S("div");for(let f=0;f<d.length;f+=1)d[f].c();we(o.src,r=l[2])||C(o,"src",r),C(o,"alt","Current Tile Preview"),C(o,"class","svelte-ks1imp"),C(n,"id","preview-image-centerer"),C(n,"class","svelte-ks1imp"),C(t,"id","terrain-preview"),C(t,"class","svelte-ks1imp"),C(h,"id","buttons"),C(h,"class","svelte-ks1imp"),C(e,"class","panel")},m(f,y){Y(f,e,y),p(e,t),p(t,n),p(n,o),p(t,i),N(a,t,null),p(t,u),g&&g.m(t,null),p(e,c),p(e,h);for(let H=0;H<d.length;H+=1)d[H].m(h,null);k=!0},p(f,[y]){(!k||y&4&&!we(o.src,r=f[2]))&&C(o,"src",r);const H={};if(!s&&y&1&&(s=!0,H.value=f[0].bgColor,z(()=>s=!1)),a.$set(H),f[0].symbolData?g?(g.p(f,y),y&1&&R(g,1)):(g=bt(f),g.c(),R(g,1),g.m(t,null)):g&&(ce(),K(g,1,1,()=>{g=null}),de()),y&10){m=Object.keys(f[1]);let T;for(T=0;T<m.length;T+=1){const v=gt(f,m,T);d[T]?d[T].p(v,y):(d[T]=kt(v),d[T].c(),d[T].m(h,null))}for(;T<d.length;T+=1)d[T].d(1);d.length=m.length}},i(f){k||(R(a.$$.fragment,f),R(g),k=!0)},o(f){K(a.$$.fragment,f),K(g),k=!1},d(f){f&&D(e),X(a),g&&g.d(),ve(d,f)}}}function Zl(l,e,t){let{loadedTilesets:n}=e,{data_terrain:o}=e,{tfield:r}=e,{app:i}=e,{L:a}=e,s=new qe,u=new $e,c=new ze;c.addChild(s).addChild(u);let h=E(o);function k(f){t(0,o.bgColor=f.bgColor,o),t(0,o.symbolData=f.symbol,o),t(2,h=E(o))}function b(f){if(r.hexWidth<r.hexHeight){let y=r.hexWidth*f.percentOfTotalHex/100/f.texWidth;return{x:y,y}}else{let y=r.hexHeight*f.percentOfTotalHex/100/f.texHeight;return{x:y,y}}}function E(f){return s.clear(),s.beginFill(f.bgColor),s.drawPolygon(Oe(50,45,r.orientation,0,0)),s.endFill(),f.symbolData?(u.texture=a.resources[f.symbolData.texId].texture,u.tint=f.symbolData.color,u.scale=b(f.symbolData),u.anchor.set(.5)):u.texture=null,i.renderer.plugins.extract.base64(c)}function g(f){l.$$.not_equal(o.bgColor,f)&&(o.bgColor=f,t(0,o))}function m(f){l.$$.not_equal(o.symbolData.color,f)&&(o.symbolData.color=f,t(0,o))}const d=f=>k(f);return l.$$set=f=>{"loadedTilesets"in f&&t(1,n=f.loadedTilesets),"data_terrain"in f&&t(0,o=f.data_terrain),"tfield"in f&&t(4,r=f.tfield),"app"in f&&t(5,i=f.app),"L"in f&&t(6,a=f.L)},l.$$.update=()=>{l.$$.dirty&1&&t(2,h=E(o))},[o,n,h,k,r,i,a,g,m,d]}class jl extends ne{constructor(e){super();oe(this,e,Zl,Gl,ie,{loadedTilesets:1,data_terrain:0,tfield:4,app:5,L:6})}}function At(l,e,t){const n=l.slice();return n[12]=e[t],n}function wt(l,e,t){const n=l.slice();return n[15]=e[t],n}function vt(l){let e,t=l[15].display+"",n,o,r,i;function a(){return l[9](l[15])}return{c(){e=S("button"),n=te(t),C(e,"class",o=Ke(l[15]==l[2]?"red":"")+" svelte-40qud0")},m(s,u){Y(s,e,u),p(e,n),r||(i=J(e,"click",a),r=!0)},p(s,u){l=s,u&2&&t!==(t=l[15].display+"")&&Ie(n,t),u&6&&o!==(o=Ke(l[15]==l[2]?"red":"")+" svelte-40qud0")&&C(e,"class",o)},d(s){s&&D(e),r=!1,i()}}}function Ct(l){let e,t=l[1][l[12]],n=[];for(let o=0;o<t.length;o+=1)n[o]=vt(wt(l,t,o));return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=he()},m(o,r){for(let i=0;i<n.length;i+=1)n[i].m(o,r);Y(o,e,r)},p(o,r){if(r&22){t=o[1][o[12]];let i;for(i=0;i<t.length;i+=1){const a=wt(o,t,i);n[i]?n[i].p(a,r):(n[i]=vt(a),n[i].c(),n[i].m(e.parentNode,e))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},d(o){ve(n,o),o&&D(e)}}}function zl(l){let e,t,n,o,r,i,a,s,u,c,h,k,b,E,g,m;function d(T){l[7](T)}let f={label:"Color"};l[0].color!==void 0&&(f.value=l[0].color),i=new lt({props:f}),V.push(()=>j(i,"value",d));let y=Object.keys(l[1]),H=[];for(let T=0;T<y.length;T+=1)H[T]=Ct(At(l,y,T));return{c(){e=S("div"),t=S("div"),n=S("img"),r=Q(),F(i.$$.fragment),s=Q(),u=S("div"),c=S("input"),h=te(" Snap to Hex"),k=Q(),b=S("div");for(let T=0;T<H.length;T+=1)H[T].c();we(n.src,o=l[3])||C(n,"src",o),C(n,"alt","Icon Preview"),C(n,"class","svelte-40qud0"),C(c,"type","checkbox"),C(u,"class","svelte-40qud0"),C(t,"id","icon-preview"),C(t,"class","svelte-40qud0"),C(b,"id","buttons"),C(b,"class","svelte-40qud0"),C(e,"class","panel svelte-40qud0")},m(T,v){Y(T,e,v),p(e,t),p(t,n),p(t,r),N(i,t,null),p(t,s),p(t,u),p(u,c),c.checked=l[0].snapToHex,p(u,h),p(e,k),p(e,b);for(let w=0;w<H.length;w+=1)H[w].m(b,null);E=!0,g||(m=J(c,"change",l[8]),g=!0)},p(T,[v]){(!E||v&8&&!we(n.src,o=T[3]))&&C(n,"src",o);const w={};if(!a&&v&1&&(a=!0,w.value=T[0].color,z(()=>a=!1)),i.$set(w),v&1&&(c.checked=T[0].snapToHex),v&22){y=Object.keys(T[1]);let I;for(I=0;I<y.length;I+=1){const U=At(T,y,I);H[I]?H[I].p(U,v):(H[I]=Ct(U),H[I].c(),H[I].m(b,null))}for(;I<H.length;I+=1)H[I].d(1);H.length=y.length}},i(T){E||(R(i.$$.fragment,T),E=!0)},o(T){K(i.$$.fragment,T),E=!1},d(T){T&&D(e),X(i),ve(H,T),g=!1,m()}}}function $l(l,e,t){let{loadedIconsets:n}=e,{L:o}=e,{app:r}=e,{data_icon:i}=e,a=n.default[0],s="";function u(g){t(2,a=g),t(0,i.texId=g.texId,i),t(0,i.color=g.color,i),t(0,i.pHex=g.pHex,i)}let c=new $e;function h(g){return c.texture=o.resources[g.texId].texture,c.tint=g.color,r.renderer.plugins.extract.base64(c)}function k(g){l.$$.not_equal(i.color,g)&&(i.color=g,t(0,i))}function b(){i.snapToHex=this.checked,t(0,i)}const E=g=>{u(g)};return l.$$set=g=>{"loadedIconsets"in g&&t(1,n=g.loadedIconsets),"L"in g&&t(5,o=g.L),"app"in g&&t(6,r=g.app),"data_icon"in g&&t(0,i=g.data_icon)},l.$$.update=()=>{l.$$.dirty&1&&t(3,s=h(i))},[i,n,a,s,u,o,r,k,b,E]}class en extends ne{constructor(e){super();oe(this,e,$l,zl,ie,{loadedIconsets:1,L:5,app:6,data_icon:0})}}function St(l,e,t){const n=l.slice();return n[12]=e[t],n}function It(l){let e,t,n,o,r,i,a,s;return{c(){e=S("div"),t=S("button"),t.textContent="Deselect Current Path",n=Q(),o=S("button"),o.textContent="Remove Last Point",r=Q(),i=S("button"),i.textContent="Delete Path",C(e,"id","selected-path-controls"),C(e,"class","svelte-17m45tf")},m(u,c){Y(u,e,c),p(e,t),p(e,n),p(e,o),p(e,r),p(e,i),a||(s=[J(t,"click",l[8]),J(o,"click",l[9]),J(i,"click",l[10])],a=!0)},p:le,d(u){u&&D(e),a=!1,_e(s)}}}function Tt(l){let e,t=l[12].display+"",n,o,r;function i(){return l[11](l[12])}return{c(){e=S("button"),n=te(t)},m(a,s){Y(a,e,s),p(e,n),o||(r=J(e,"click",i),o=!0)},p(a,s){l=a},d(a){a&&D(e),o=!1,r()}}}function tn(l){let e,t,n,o,r,i,a,s,u,c,h,k,b,E,g,m,d,f,y,H,T,v,w,I;function U(_){l[3](_)}let P={label:"Color"};l[0].colorString!==void 0&&(P.value=l[0].colorString),n=new Ge({props:P}),V.push(()=>j(n,"value",U));let O=l[0].selectedPath&&It(l),M=l[2],A=[];for(let _=0;_<M.length;_+=1)A[_]=Tt(St(l,M,_));return{c(){e=S("div"),t=S("div"),F(n.$$.fragment),r=te(`\r
            Thickness `),i=S("input"),a=te(`\r
            Snap `),s=S("input"),u=te(`\r
\r
            Line Ends\r
            `),c=S("select"),h=S("option"),h.textContent="Butt",k=S("option"),k.textContent="Round",b=S("option"),b.textContent="Square",E=te(`\r
\r
            Corners\r
            `),g=S("select"),m=S("option"),m.textContent="Round",d=S("option"),d.textContent="Spiky",f=S("option"),f.textContent="Flat",y=Q(),O&&O.c(),H=Q(),T=S("div");for(let _=0;_<A.length;_+=1)A[_].c();C(i,"type","number"),C(s,"type","checkbox"),h.__value="butt",h.value=h.__value,k.__value="round",k.value=k.__value,b.__value="square",b.value=b.__value,l[0].style.cap===void 0&&Ue(()=>l[6].call(c)),m.__value="round",m.value=m.__value,d.__value="miter",d.value=d.__value,f.__value="bevel",f.value=f.__value,l[0].style.join===void 0&&Ue(()=>l[7].call(g)),C(t,"id","controls"),C(t,"class","svelte-17m45tf"),C(T,"id","path-styles"),C(T,"class","svelte-17m45tf"),C(e,"class","panel svelte-17m45tf")},m(_,L){Y(_,e,L),p(e,t),N(n,t,null),p(t,r),p(t,i),q(i,l[0].style.width),p(t,a),p(t,s),s.checked=l[0].snap,p(t,u),p(t,c),p(c,h),p(c,k),p(c,b),me(c,l[0].style.cap),p(t,E),p(t,g),p(g,m),p(g,d),p(g,f),me(g,l[0].style.join),p(e,y),O&&O.m(e,null),p(e,H),p(e,T);for(let G=0;G<A.length;G+=1)A[G].m(T,null);v=!0,w||(I=[J(i,"input",l[4]),J(s,"change",l[5]),J(c,"change",l[6]),J(g,"change",l[7])],w=!0)},p(_,[L]){const G={};if(!o&&L&1&&(o=!0,G.value=_[0].colorString,z(()=>o=!1)),n.$set(G),L&1&&pe(i.value)!==_[0].style.width&&q(i,_[0].style.width),L&1&&(s.checked=_[0].snap),L&1&&me(c,_[0].style.cap),L&1&&me(g,_[0].style.join),_[0].selectedPath?O?O.p(_,L):(O=It(_),O.c(),O.m(e,H)):O&&(O.d(1),O=null),L&5){M=_[2];let W;for(W=0;W<M.length;W+=1){const Z=St(_,M,W);A[W]?A[W].p(Z,L):(A[W]=Tt(Z),A[W].c(),A[W].m(T,null))}for(;W<A.length;W+=1)A[W].d(1);A.length=M.length}},i(_){v||(R(n.$$.fragment,_),v=!0)},o(_){K(n.$$.fragment,_),v=!1},d(_){_&&D(e),X(n),O&&O.d(),ve(A,_),w=!1,_e(I)}}}function ln(l,e,t){let{comp_pathLayer:n}=e,{data_path:o}=e,r=[{display:"Green",style:{color:65280,width:13,cap:"round",join:"round"}},{display:"Red",style:{color:16711680,width:3,cap:"round",join:"bevel"}}];function i(g){l.$$.not_equal(o.colorString,g)&&(o.colorString=g,t(0,o))}function a(){o.style.width=pe(this.value),t(0,o)}function s(){o.snap=this.checked,t(0,o)}function u(){o.style.cap=Pe(this),t(0,o)}function c(){o.style.join=Pe(this),t(0,o)}const h=()=>{t(0,o.selectedPath=null,o)},k=()=>{n.removeLastPoint(o.selectedPath)},b=()=>{n.deletePath(o.selectedPath)},E=g=>{t(0,o.colorString=De(g.style.color),o),t(0,o.style=ue({},g.style),o)};return l.$$set=g=>{"comp_pathLayer"in g&&t(1,n=g.comp_pathLayer),"data_path"in g&&t(0,o=g.data_path)},l.$$.update=()=>{l.$$.dirty&1&&t(0,o.style.color=tt(o.colorString),o),l.$$.dirty&1&&o.selectedPath&&t(0,o.selectedPath.style=ue({},o.style),o)},[o,n,r,i,a,s,u,c,h,k,b,E]}class nn extends ne{constructor(e){super();oe(this,e,ln,tn,ie,{comp_pathLayer:1,data_path:0})}}function Et(l,e,t){const n=l.slice();return n[13]=e[t],n}function Bt(l){let e,t,n,o,r,i,a;return{c(){e=S("div"),t=S("button"),t.textContent="Delete Text",n=Q(),o=S("textarea"),C(e,"id","selected-text-controls"),C(e,"class","svelte-1opwxhg")},m(s,u){Y(s,e,u),p(e,t),p(e,n),p(e,o),q(o,l[0].selectedText.text),l[11](o),i||(a=[J(t,"click",l[9]),J(o,"input",l[10]),ml(r=sn.call(null,o))],i=!0)},p(s,u){u&1&&q(o,s[0].selectedText.text)},d(s){s&&D(e),l[11](null),i=!1,_e(a)}}}function Ht(l){let e,t=l[13].display+"",n,o,r;function i(){return l[12](l[13])}return{c(){e=S("button"),n=te(t)},m(a,s){Y(a,e,s),p(e,n),o||(r=J(e,"click",i),o=!0)},p(a,s){l=a},d(a){a&&D(e),o=!1,r()}}}function on(l){let e,t,n,o,r,i,a,s,u,c,h,k,b,E,g,m,d,f,y,H,T,v,w,I,U,P,O,M,A,_,L;function G(x){l[3](x)}let W={label:"Color"};l[0].style.fill!==void 0&&(W.value=l[0].style.fill),n=new Ge({props:W}),V.push(()=>j(n,"value",G));function Z(x){l[5](x)}let Ae={label:"Stroke"};l[0].style.stroke!==void 0&&(Ae.value=l[0].style.stroke),s=new Ge({props:Ae}),V.push(()=>j(s,"value",Z));let $=l[0].selectedText&&Bt(l),ye=l[2],ee=[];for(let x=0;x<ye.length;x+=1)ee[x]=Ht(Et(l,ye,x));return{c(){e=S("div"),t=S("div"),F(n.$$.fragment),r=Q(),i=S("input"),a=Q(),F(s.$$.fragment),c=Q(),h=S("input"),k=Q(),b=S("select"),E=S("option"),E.textContent="Segoe UI",g=S("option"),g.textContent="Comic Sans",m=S("option"),m.textContent="Arial",d=S("option"),d.textContent="Times New Roman",f=Q(),y=S("select"),H=S("option"),H.textContent="Left",T=S("option"),T.textContent="Center",v=S("option"),v.textContent="Right",w=Q(),$&&$.c(),I=Q(),U=S("div"),P=S("p"),P.textContent="Text Styles",O=Q();for(let x=0;x<ee.length;x+=1)ee[x].c();C(i,"type","number"),C(h,"type","number"),E.__value="Segoe UI",E.value=E.__value,g.__value="Comic Sans MS",g.value=g.__value,m.__value="Arial",m.value=m.__value,d.__value="Times New Roman",d.value=d.__value,l[0].style.fontFamily===void 0&&Ue(()=>l[7].call(b)),H.__value="left",H.value=H.__value,T.__value="center",T.value=T.__value,v.__value="right",v.value=v.__value,l[0].style.align===void 0&&Ue(()=>l[8].call(y)),C(t,"id","controls"),C(t,"class","svelte-1opwxhg"),C(P,"class","svelte-1opwxhg"),C(U,"id","text-styles"),C(U,"style",M=l[0].selectedText?"padding-top: 10px":""),C(U,"class","svelte-1opwxhg"),C(e,"class","panel svelte-1opwxhg")},m(x,se){Y(x,e,se),p(e,t),N(n,t,null),p(t,r),p(t,i),q(i,l[0].style.fontSize),p(t,a),N(s,t,null),p(t,c),p(t,h),q(h,l[0].style.strokeThickness),p(t,k),p(t,b),p(b,E),p(b,g),p(b,m),p(b,d),me(b,l[0].style.fontFamily),p(t,f),p(t,y),p(y,H),p(y,T),p(y,v),me(y,l[0].style.align),p(e,w),$&&$.m(e,null),p(e,I),p(e,U),p(U,P),p(U,O);for(let ke=0;ke<ee.length;ke+=1)ee[ke].m(U,null);A=!0,_||(L=[J(i,"input",l[4]),J(h,"input",l[6]),J(b,"change",l[7]),J(y,"change",l[8])],_=!0)},p(x,[se]){const ke={};!o&&se&1&&(o=!0,ke.value=x[0].style.fill,z(()=>o=!1)),n.$set(ke),se&1&&pe(i.value)!==x[0].style.fontSize&&q(i,x[0].style.fontSize);const Me={};if(!u&&se&1&&(u=!0,Me.value=x[0].style.stroke,z(()=>u=!1)),s.$set(Me),se&1&&pe(h.value)!==x[0].style.strokeThickness&&q(h,x[0].style.strokeThickness),se&1&&me(b,x[0].style.fontFamily),se&1&&me(y,x[0].style.align),x[0].selectedText?$?$.p(x,se):($=Bt(x),$.c(),$.m(e,I)):$&&($.d(1),$=null),se&5){ye=x[2];let re;for(re=0;re<ye.length;re+=1){const Le=Et(x,ye,re);ee[re]?ee[re].p(Le,se):(ee[re]=Ht(Le),ee[re].c(),ee[re].m(U,null))}for(;re<ee.length;re+=1)ee[re].d(1);ee.length=ye.length}(!A||se&1&&M!==(M=x[0].selectedText?"padding-top: 10px":""))&&C(U,"style",M)},i(x){A||(R(n.$$.fragment,x),R(s.$$.fragment,x),A=!0)},o(x){K(n.$$.fragment,x),K(s.$$.fragment,x),A=!1},d(x){x&&D(e),X(n),X(s),$&&$.d(),ve(ee,x),_=!1,_e(L)}}}function sn(l){setTimeout(()=>{l.focus()},10)}function rn(l,e,t){let{data_text:n}=e,{comp_textLayer:o}=e,r=[{display:"Big",style:{fontFamily:"Segoe UI",fill:"#000000",fontSize:40,miterLimit:2,strokeThickness:5,stroke:"#f2f2f2"}},{display:"Little",style:{fontFamily:"Segoe UI",fill:"#000000",fontSize:25,miterLimit:2,strokeThickness:0,stroke:"#f2f2f2"}}];function i(m){l.$$.not_equal(n.style.fill,m)&&(n.style.fill=m,t(0,n))}function a(){n.style.fontSize=pe(this.value),t(0,n)}function s(m){l.$$.not_equal(n.style.stroke,m)&&(n.style.stroke=m,t(0,n))}function u(){n.style.strokeThickness=pe(this.value),t(0,n)}function c(){n.style.fontFamily=Pe(this),t(0,n)}function h(){n.style.align=Pe(this),t(0,n)}const k=()=>{o.deleteText(n.selectedText)};function b(){n.selectedText.text=this.value,t(0,n)}function E(m){V[m?"unshift":"push"](()=>{n.editorRef=m,t(0,n)})}const g=m=>{t(0,n.style=ue({},m.style),n)};return l.$$set=m=>{"data_text"in m&&t(0,n=m.data_text),"comp_textLayer"in m&&t(1,o=m.comp_textLayer)},[n,o,r,i,a,s,u,c,h,k,b,E,g]}class an extends ne{constructor(e){super();oe(this,e,rn,on,ie,{data_text:0,comp_textLayer:1})}}function Ut(l,e,t){const n=l.slice();return n[3]=e[t],n}function Pt(l){let e,t,n,o,r,i,a,s,u;function c(...h){return l[2](l[3],...h)}return{c(){e=S("button"),t=S("img"),r=Q(),we(t.src,n=`/assets/img/tools/${l[3].toolCode}.png`)||C(t,"src",n),C(t,"alt",o=`${l[3].toolCode} Tool`),C(e,"class",i=Ke(l[0]==l[3].toolCode?"selected":"")+" svelte-d5jxfa"),C(e,"title",a=`${l[3].display} tool`)},m(h,k){Y(h,e,k),p(e,t),p(e,r),s||(u=J(e,"click",c),s=!0)},p(h,k){l=h,k&1&&i!==(i=Ke(l[0]==l[3].toolCode?"selected":"")+" svelte-d5jxfa")&&C(e,"class",i)},d(h){h&&D(e),s=!1,u()}}}function un(l){let e,t=l[1],n=[];for(let o=0;o<t.length;o+=1)n[o]=Pt(Ut(l,t,o));return{c(){e=S("main");for(let o=0;o<n.length;o+=1)n[o].c();C(e,"class","svelte-d5jxfa")},m(o,r){Y(o,e,r);for(let i=0;i<n.length;i+=1)n[i].m(e,null)},p(o,[r]){if(r&3){t=o[1];let i;for(i=0;i<t.length;i+=1){const a=Ut(o,t,i);n[i]?n[i].p(a,r):(n[i]=Pt(a),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=t.length}},i:le,o:le,d(o){o&&D(e),ve(n,o)}}}function fn(l,e,t){let n=[{display:"Terrain",toolCode:"terrain"},{display:"Icon",toolCode:"icon"},{display:"Path",toolCode:"path"},{display:"Text",toolCode:"text"},{display:"Eraser",toolCode:"eraser"}],{selectedTool:o}=e;const r=(i,a)=>{t(0,o=i.toolCode)};return l.$$set=i=>{"selectedTool"in i&&t(0,o=i.selectedTool)},[o,n,r]}class cn extends ne{constructor(e){super();oe(this,e,fn,un,ie,{selectedTool:0})}}function dn(l,e,t){var n=window,o="application/octet-stream",r=t||o,i=l,a=document,s=a.createElement("a"),u=function(f){return String(f)},c=n.Blob||n.MozBlob||n.WebKitBlob||u,h=n.MSBlobBuilder||n.WebKitBlobBuilder||n.BlobBuilder,k=e||"download",b,E,g;if(String(this)==="true"&&(i=[i,r],r=i[0],i=i[1]),String(i).match(/^data\:[\w+\-]+\/[\w+\-]+[,;]/))return navigator.msSaveBlob?navigator.msSaveBlob(m(i),k):d(i);try{b=i instanceof c?i:new c([i],{type:r})}catch{h&&(E=new h,E.append([i]),b=E.getBlob(r))}function m(f){var y=f.split(/[:;,]/),H=y[1],T=y[2]=="base64"?atob:decodeURIComponent,v=T(y.pop()),w=v.length,I=0,U=new Uint8Array(w);for(I;I<w;++I)U[I]=v.charCodeAt(I);return new c([U],{type:H})}function d(f,y){if("download"in s)return s.href=f,s.setAttribute("download",k),s.innerHTML="downloading...",a.body.appendChild(s),setTimeout(function(){s.click(),a.body.removeChild(s),y===!0&&setTimeout(function(){n.URL.revokeObjectURL(s.href)},250)},66),!0;var H=a.createElement("iframe");a.body.appendChild(H),y||(f="data:"+f.replace(/^data:([\w\/\-\+]+)/,o)),H.src=f,setTimeout(function(){a.body.removeChild(H)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(b,k);if(n.URL)d(n.URL.createObjectURL(b),!0);else{if(typeof b=="string"||b.constructor===u)try{return d("data:"+r+";base64,"+n.btoa(b))}catch{return d("data:"+r+","+encodeURIComponent(b))}g=new FileReader,g.onload=function(f){d(this.result)},g.readAsDataURL(b)}return!0}function Qt(l,e,t){const n=l.slice();return n[30]=e[t],n}function Rt(l){let e,t=l[30].display+"",n,o,r;function i(){return l[16](l[30])}return{c(){e=S("button"),n=te(t),C(e,"class","tile-button svelte-1ppluyc")},m(a,s){Y(a,e,s),p(e,n),o||(r=J(e,"click",i),o=!0)},p(a,s){l=a,s[0]&1&&t!==(t=l[30].display+"")&&Ie(n,t)},d(a){a&&D(e),o=!1,r()}}}function pn(l){let e;return{c(){e=S("div"),e.innerHTML="<p>Select a tile or make a new one!</p>",C(e,"id","editor-placeholder"),C(e,"class","svelte-1ppluyc")},m(t,n){Y(t,e,n)},p:le,i:le,o:le,d(t){t&&D(e)}}}function _n(l){let e,t,n,o,r,i,a,s,u,c,h,k,b,E,g;t=new Vt({props:{app:l[8],$$slots:{default:[hn]},$$scope:{ctx:l}}});let m=l[0][l[1]].symbol&&Lt(l);return{c(){e=S("div"),F(t.$$.fragment),n=Q(),o=S("input"),r=Q(),i=S("button"),i.textContent="Change Orientation",a=Q(),s=S("div"),u=S("input"),c=Q(),h=S("input"),k=Q(),m&&m.c(),C(o,"type","text"),C(e,"id","tile-preview"),C(u,"type","color"),C(h,"type","file"),C(s,"id","tile-controls")},m(d,f){Y(d,e,f),N(t,e,null),p(e,n),p(e,o),q(o,l[0][l[1]].display),p(e,r),p(e,i),Y(d,a,f),Y(d,s,f),p(s,u),q(u,l[0][l[1]].bgColor),p(s,c),p(s,h),l[24](h),p(s,k),m&&m.m(s,null),b=!0,E||(g=[J(o,"input",l[20]),J(i,"click",l[21]),J(u,"input",l[22]),J(h,"change",l[23])],E=!0)},p(d,f){const y={};f[0]&91|f[1]&4&&(y.$$scope={dirty:f,ctx:d}),t.$set(y),f[0]&3&&o.value!==d[0][d[1]].display&&q(o,d[0][d[1]].display),f[0]&3&&q(u,d[0][d[1]].bgColor),d[0][d[1]].symbol?m?m.p(d,f):(m=Lt(d),m.c(),m.m(s,null)):m&&(m.d(1),m=null)},i(d){b||(R(t.$$.fragment,d),b=!0)},o(d){K(t.$$.fragment,d),b=!1},d(d){d&&D(e),X(t),d&&D(a),d&&D(s),l[24](null),m&&m.d(),E=!1,_e(g)}}}function Mt(l){let e,t;return e=new Ft({props:{texture:l[4],tint:l[0][l[1]].symbol.color,x:150,y:150,scale:{x:l[6],y:l[6]},anchor:{x:.5,y:.5}}}),{c(){F(e.$$.fragment)},m(n,o){N(e,n,o),t=!0},p(n,o){const r={};o[0]&16&&(r.texture=n[4]),o[0]&3&&(r.tint=n[0][n[1]].symbol.color),o[0]&64&&(r.scale={x:n[6],y:n[6]}),e.$set(r)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function hn(l){let e,t,n,o=l[0][l[1]].symbol&&Mt(l);return t=new Qe({props:{draw:l[19]}}),{c(){o&&o.c(),e=Q(),F(t.$$.fragment)},m(r,i){o&&o.m(r,i),Y(r,e,i),N(t,r,i),n=!0},p(r,i){r[0][r[1]].symbol?o?(o.p(r,i),i[0]&3&&R(o,1)):(o=Mt(r),o.c(),R(o,1),o.m(e.parentNode,e)):o&&(ce(),K(o,1,1,()=>{o=null}),de());const a={};i[0]&8&&(a.draw=r[19]),t.$set(a)},i(r){n||(R(o),R(t.$$.fragment,r),n=!0)},o(r){K(o),K(t.$$.fragment,r),n=!1},d(r){o&&o.d(r),r&&D(e),X(t,r)}}}function Lt(l){let e,t,n,o,r;return{c(){e=S("input"),t=Q(),n=S("button"),n.textContent="Remove Icon",C(e,"type","color")},m(i,a){Y(i,e,a),q(e,l[0][l[1]].symbol.color),Y(i,t,a),Y(i,n,a),o||(r=[J(e,"input",l[25]),J(n,"click",l[26])],o=!0)},p(i,a){a[0]&3&&q(e,i[0][i[1]].symbol.color)},d(i){i&&D(e),i&&D(t),i&&D(n),o=!1,_e(r)}}}function gn(l){let e,t,n,o,r,i,a,s,u,c,h,k,b,E,g,m,d=l[0],f=[];for(let v=0;v<d.length;v+=1)f[v]=Rt(Qt(l,d,v));const y=[_n,pn],H=[];function T(v,w){return v[1]>=0?0:1}return k=T(l),b=H[k]=y[k](l),{c(){e=S("main"),t=S("div"),n=S("button"),n.textContent="Exit Tileset Builder",o=Q(),r=S("input"),i=Q();for(let v=0;v<f.length;v+=1)f[v].c();a=Q(),s=S("button"),s.textContent="+",u=Q(),c=S("button"),c.textContent="Export",h=Q(),b.c(),C(r,"type","text"),C(s,"class","tile-button svelte-1ppluyc"),C(t,"id","buttons"),C(t,"class","svelte-1ppluyc"),C(e,"class","svelte-1ppluyc")},m(v,w){Y(v,e,w),p(e,t),p(t,n),p(t,o),p(t,r),q(r,l[2]),p(t,i);for(let I=0;I<f.length;I+=1)f[I].m(t,null);p(t,a),p(t,s),p(t,u),p(t,c),p(e,h),H[k].m(e,null),E=!0,g||(m=[J(n,"click",l[14]),J(r,"input",l[15]),J(s,"click",l[17]),J(c,"click",l[18])],g=!0)},p(v,w){if(w[0]&4&&r.value!==v[2]&&q(r,v[2]),w[0]&1025){d=v[0];let U;for(U=0;U<d.length;U+=1){const P=Qt(v,d,U);f[U]?f[U].p(P,w):(f[U]=Rt(P),f[U].c(),f[U].m(t,a))}for(;U<f.length;U+=1)f[U].d(1);f.length=d.length}let I=k;k=T(v),k===I?H[k].p(v,w):(ce(),K(H[I],1,1,()=>{H[I]=null}),de(),b=H[k],b?b.p(v,w):(b=H[k]=y[k](v),b.c()),R(b,1),b.m(e,null))},i(v){E||(R(b),E=!0)},o(v){K(b),E=!1},d(v){v&&D(e),ve(f,v),H[k].d(),g=!1,_e(m)}}}const mn="#f2f2f2";function bn(l,e,t){let n,o=bl();function r(){o("appstatechange",{newState:"normal"})}let i=new Xt({width:300,height:300,backgroundAlpha:0}),a="default",s="flatTop",u=[],c=-1,h=new qt,k,b;function E(W){let Z=W.target.files[0],Ae=new FileReader;Ae.readAsDataURL(Z),Ae.onload=$=>{h.reset(),h.add("s",$.target.result),h.load(()=>{t(4,k=h.resources.s.texture),t(0,u[c].symbol={color:u[c].symbol?u[c].symbol.color:"#ffffff",base64:$.target.result,imageWidth:h.resources.s.texture.width,imageHeight:h.resources.s.texture.height},u)})}}const g=tt(mn);function m(W){t(1,c=W)}function d(){let W=u.map(Z=>({display:Z.display,bgColor:Z.bgColor,id:a+"_"+Z.display.replace(" ","-"),symbol:Z.symbol}));dn(JSON.stringify(W),a+".hfts")}function f(){t(0,u=[...u,{display:"New Hex",bgColor:g,symbol:null}]),m(u.length-1)}function y(){t(0,u[c].symbol=null,u),t(4,k=null),t(5,b.value=null,b),t(0,u)}const H=W=>r();function T(){a=this.value,t(2,a)}const v=W=>{m(u.indexOf(W))},w=()=>{f()},I=()=>d(),U=W=>{W.clear(),W.beginFill(bgColorPixi),W.drawPolygon(Bl(150,s,150,150)),W.endFill()};function P(){u[c].display=this.value,t(0,u)}const O=()=>{t(3,s=s=="flatTop"?"pointyTop":"flatTop")};function M(){u[c].bgColor=this.value,t(0,u)}const A=W=>E(W);function _(W){V[W?"unshift":"push"](()=>{b=W,t(5,b)})}function L(){u[c].symbol.color=this.value,t(0,u)}const G=W=>y();return l.$$.update=()=>{l.$$.dirty[0]&3&&t(6,n=c!=-1&&u[c].symbol?280/u[c].symbol.texWidth:0)},[u,c,a,s,k,b,n,r,i,E,m,d,f,y,H,T,v,w,I,U,P,O,M,A,_,L,G]}class yn extends ne{constructor(e){super();oe(this,e,bn,gn,ie,{},null,[-1,-1])}}function Jt(l,e,t){const n=l.slice();return n[9]=e[t],n}function Yt(l,e){let t,n,o,r,i,a,s,u=JSON.parse(e[9].mapString).title+"",c,h,k,b,E,g;function m(){return e[7](e[9])}function d(){return e[8](e[9])}return{key:l,first:null,c(){t=S("div"),n=S("div"),o=S("div"),r=S("img"),a=Q(),s=S("p"),c=te(u),h=Q(),k=S("button"),k.textContent="Delete",b=Q(),we(r.src,i=e[9].previewBase64)||C(r,"src",i),C(r,"alt","Map Preview"),C(r,"class","svelte-48iowl"),C(o,"id","image-container"),C(o,"class","svelte-48iowl"),C(s,"class","svelte-48iowl"),C(n,"class","svelte-48iowl"),C(k,"class","delete-button svelte-48iowl"),C(t,"id","map-save"),C(t,"class","svelte-48iowl"),this.first=t},m(f,y){Y(f,t,y),p(t,n),p(n,o),p(o,r),p(n,a),p(n,s),p(s,c),p(t,h),p(t,k),p(t,b),E||(g=[J(n,"click",m),J(k,"click",d)],E=!0)},p(f,y){e=f,y&2&&!we(r.src,i=e[9].previewBase64)&&C(r,"src",i),y&2&&u!==(u=JSON.parse(e[9].mapString).title+"")&&Ie(c,u)},d(f){f&&D(t),E=!1,_e(g)}}}function kn(l){let e,t,n,o,r=[],i=new Map,a,s,u=l[1]||[];const c=h=>h[9].id;for(let h=0;h<u.length;h+=1){let k=Jt(l,u,h),b=c(k);i.set(b,r[h]=Yt(b,k))}return{c(){e=S("div"),t=S("div"),n=S("button"),n.textContent="Close",o=Q();for(let h=0;h<r.length;h+=1)r[h].c();C(t,"id","maps"),C(t,"class","svelte-48iowl"),C(e,"id","maps-container"),C(e,"class","svelte-48iowl")},m(h,k){Y(h,e,k),p(e,t),p(t,n),p(t,o);for(let b=0;b<r.length;b+=1)r[b].m(t,null);a||(s=J(n,"click",l[6]),a=!0)},p(h,[k]){k&26&&(u=h[1]||[],r=Re(r,k,c,1,h,u,i,t,Nt,Yt,null,Jt))},i:le,o:le,d(h){h&&D(e);for(let k=0;k<r.length;k+=1)r[k].d();a=!1,s()}}}function An(l,e,t){let n,o=yl(()=>We.mapSaves.toArray());kl(l,o,k=>t(1,n=k));let{showSavedMaps:r}=e,{load:i}=e;function a(k,b){let E=JSON.parse(k);i(E,b),t(0,r=!1)}function s(k){We.mapSaves.delete(k)}const u=()=>{t(0,r=!1)},c=k=>{a(k.mapString,k.id)},h=k=>{s(k.id)};return l.$$set=k=>{"showSavedMaps"in k&&t(0,r=k.showSavedMaps),"load"in k&&t(5,i=k.load)},[r,n,o,a,s,i,u,c,h]}class wn extends ne{constructor(e){super();oe(this,e,An,kn,ie,{showSavedMaps:0,load:5})}}function Dt(l){let e,t,n;return{c(){e=S("input"),C(e,"type","number")},m(o,r){Y(o,e,r),q(e,l[1].grid.thickness),t||(n=[J(e,"input",l[11]),J(e,"change",function(){Ye(l[4])&&l[4].apply(this,arguments)})],t=!0)},p(o,r){l=o,r&2&&pe(e.value)!==l[1].grid.thickness&&q(e,l[1].grid.thickness)},d(o){o&&D(e),t=!1,_e(n)}}}function vn(l){let e,t,n,o,r,i,a,s,u,c,h,k,b,E,g,m,d,f,y,H,T,v,w,I=l[1].grid.shown&&Dt(l);const U=l[6].default,P=Al(U,l,l[5],null);return{c(){e=S("div"),t=S("div"),n=te("Title: "),o=S("input"),r=Q(),i=S("button"),i.textContent="Close",a=Q(),s=S("button"),s.textContent="Save and Close",u=te(`\r
\r
        Show Grid `),c=S("input"),h=Q(),I&&I.c(),k=Q(),b=S("select"),E=S("option"),E.textContent="Flat Topped",g=S("option"),g.textContent="Pointy Topped",m=Q(),d=S("input"),f=Q(),y=S("input"),H=Q(),P&&P.c(),C(o,"type","text"),C(c,"type","checkbox"),E.__value="flatTop",E.value=E.__value,g.__value="pointyTop",g.value=g.__value,l[1].orientation===void 0&&Ue(()=>l[12].call(b)),C(d,"type","number"),C(y,"type","number"),C(t,"id","settings"),C(t,"class","svelte-1gl7xx8"),C(e,"id","settings-container"),C(e,"class","svelte-1gl7xx8")},m(O,M){Y(O,e,M),p(e,t),p(t,n),p(t,o),q(o,l[0].title),p(t,r),p(t,i),p(t,a),p(t,s),p(t,u),p(t,c),c.checked=l[1].grid.shown,p(t,h),I&&I.m(t,null),p(t,k),p(t,b),p(b,E),p(b,g),me(b,l[1].orientation),p(t,m),p(t,d),q(d,l[1].hexWidth),p(t,f),p(t,y),q(y,l[1].hexHeight),p(t,H),P&&P.m(t,null),T=!0,v||(w=[J(o,"input",l[7]),J(i,"click",l[8]),J(s,"click",l[9]),J(c,"change",l[10]),J(b,"change",l[12]),J(b,"change",function(){Ye(l[4])&&l[4].apply(this,arguments)}),J(d,"input",l[13]),J(d,"change",function(){Ye(l[4])&&l[4].apply(this,arguments)}),J(y,"input",l[14]),J(y,"change",function(){Ye(l[4])&&l[4].apply(this,arguments)})],v=!0)},p(O,[M]){l=O,M&1&&o.value!==l[0].title&&q(o,l[0].title),M&2&&(c.checked=l[1].grid.shown),l[1].grid.shown?I?I.p(l,M):(I=Dt(l),I.c(),I.m(t,k)):I&&(I.d(1),I=null),M&2&&me(b,l[1].orientation),M&2&&pe(d.value)!==l[1].hexWidth&&q(d,l[1].hexWidth),M&2&&pe(y.value)!==l[1].hexHeight&&q(y,l[1].hexHeight),P&&P.p&&(!T||M&32)&&wl(P,U,l,l[5],T?Cl(U,l[5],M,null):vl(l[5]),null)},i(O){T||(R(P,O),T=!0)},o(O){K(P,O),T=!1},d(O){O&&D(e),I&&I.d(),P&&P.d(O),v=!1,_e(w)}}}function Cn(l,e,t){let{$$slots:n={},$$scope:o}=e,{loadedSave:r}=e,{tfield:i}=e,{showSettings:a}=e,{save:s}=e,{renderAllHexes:u}=e;function c(){r.title=this.value,t(0,r)}const h=()=>{t(2,a=!1)},k=()=>{s(),t(2,a=!1)};function b(){i.grid.shown=this.checked,t(1,i)}function E(){i.grid.thickness=pe(this.value),t(1,i)}function g(){i.orientation=Pe(this),t(1,i)}function m(){i.hexWidth=pe(this.value),t(1,i)}function d(){i.hexHeight=pe(this.value),t(1,i)}return l.$$set=f=>{"loadedSave"in f&&t(0,r=f.loadedSave),"tfield"in f&&t(1,i=f.tfield),"showSettings"in f&&t(2,a=f.showSettings),"save"in f&&t(3,s=f.save),"renderAllHexes"in f&&t(4,u=f.renderAllHexes),"$$scope"in f&&t(5,o=f.$$scope)},[r,i,a,s,u,o,n,c,h,k,b,E,g,m,d]}class Sn extends ne{constructor(e){super();oe(this,e,Cn,vn,ie,{loadedSave:0,tfield:1,showSettings:2,save:3,renderAllHexes:4})}}let In={default_plains:{default_plains:50,default_desert:0,default_water:15,default_tree:20,default_deepwater:15},default_desert:{default_plains:30,default_desert:30,default_water:20,default_tree:20,default_deepwater:0},default_water:{default_plains:35,default_desert:0,default_water:40,default_tree:25,default_deepwater:0},default_tree:{default_plains:25,default_desert:0,default_water:10,default_tree:65,default_deepwater:0},default_deepwater:{default_plains:50,default_desert:0,default_water:0,default_tree:0,default_deepwater:50}};function Ce(l,e,t){return l.toString()+":"+e.toString()+":"+t.toString()}function Tn(l,e){return l=Math.ceil(l),e=Math.floor(e),Math.floor(Math.random()*(e-l)+l)}function En(l,e,t){return[Ce(l+1,e,t-1),Ce(l+1,e-1,t),Ce(l,e-1,t+1),Ce(l-1,e,t+1),Ce(l-1,e+1,t),Ce(l,e+1,t-1)]}function Bn(l,e){let t=[],n=[];for(t.push({generateFrom:null,hexId:"0:0:0"});t.length!=0;){let r=t.pop(),i=l.hexes[r.hexId],a;if(r.generateFrom==null)a="default_plains",Kt(i,"default_plains",e);else{let u=Tn(1,100);var o=0;for(let[c,h]of Object.entries(In[r.generateFrom]))if(o+=h,u<=o){Kt(i,c,e),a=c,l.hexes=l.hexes;break}}En(i.q,i.r,i.s).forEach(u=>{l.hexes[u]!=null&&n.find(c=>c==u)==null&&t.find(c=>c.hexId==u)==null&&t.push({generateFrom:a,hexId:u})}),n.push(r.hexId)}}function Kt(l,e,t){let n=t.find(o=>o.id==e);l.bgColor=n.bgColor,n.symbol?(l.symbol=ue({},n.symbol),l.symbolId=n.id):(l.symbol=null,l.symbolId=null)}const Hn=1;let Ze={saveVersion:Hn,title:"",TerrainField:{hexWidth:50,hexHeight:45,orientation:"flatTop",blankHexColor:15921906,grid:{stroke:3355443,thickness:2,shown:!0},hexes:{}},tilesets:{default:[{display:"Plains",id:"default_plains",bgColor:11462236,symbol:null},{display:"Desert",id:"default_desert",bgColor:16772676,symbol:null},{display:"Beach",id:"default_beach",bgColor:16318111,symbol:null},{display:"Deep Water",id:"default_deepwater",bgColor:1465244,symbol:null},{display:"Water",id:"default_water",bgColor:11788537,symbol:null},{display:"Tree",id:"default_tree",bgColor:9225791,symbol:{texId:"default_tree",color:4029989,texWidth:100,texHeight:100,percentOfTotalHex:80,base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAKVSURBVHhe7Z2LUsIwEEXBz9Lv199CV8kMlIKkZXfPJvfMdEBmSkpObl5WOZ5Op4Pg8HZ+FBAkBIaEwJAQGBICQ0JgSAiMzHXI3oKP58ehiE7I+89hIl7RCl71PigiE+JZ0DIta2WVSFRUQrytX77/vbLs9XZgGWlQ76lorJwIIZEfektZdo6NbQgixhBcK3xA+jijdcg16Y1HQm5JlSIh66RJiRAy5Irai6iEVJSSkpLILsuktOPDXhC3ZGwups9kOghPdvSgjlmAUYkSYqmw4/P3pzqENyCt1P8ntNvyTkh1GUZLd8hn8RQygowl7mK8hIwoI4ToWdYouDU4DyGzpMPlcyohMCQEhoTAkBAYHkLCN+RGwishkrIRzy7LpEhMJxFjSBMjOU8QNajbIkrbKU8QIUQiOvAWIhmdRHVZI+IyJnoKUTo2oIRsw23G6Pk79eoJSZmmKyEwPIVoIbgB74RISicRXZZJseMV9/P2Ct7aINIaUsa9vUZvoZcV1HOunbenrHCyhCy5dxFrldMrxHjmnFQRDYqQHrYIKYOmvTAkBIaEwJAQGBICo5qQclPCXpQQGBICo5KQ4bsrQwmBISEwJASGhMCoImSKAd1QQmBICAwJgVFByJ7xo9zYo4TAoAuZZnbVUEJgzCCkVMrIQqbrroxZuqwycqlCPCqwxH9Epd656HVR+DsZiQnxbCH4rosmJKLC0FJIQiIryspCiplllnUPnBSKkMyKQUkhCCFUiF0DQszsXdaSdDHZQhCtcoU0MUrIY8KlSMgttpq/PEIhbJ1kXwBqO4WQkNYSI74ozMpo5bUDBXVz0XZm93w9klX819/TWlT8O/Wh0aAOQ0JgSAgMCYEhITAkBIaEwJAQFIfDN2Shgz9c4BjXAAAAAElFTkSuQmCC"}},{display:"Fire Tree",id:"default_firetree",bgColor:16772676,symbol:{texId:"default_tree",color:11158545,texWidth:100,texHeight:100,percentOfTotalHex:80,base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAKVSURBVHhe7Z2LUsIwEEXBz9Lv199CV8kMlIKkZXfPJvfMdEBmSkpObl5WOZ5Op4Pg8HZ+FBAkBIaEwJAQGBICQ0JgSAiMzHXI3oKP58ehiE7I+89hIl7RCl71PigiE+JZ0DIta2WVSFRUQrytX77/vbLs9XZgGWlQ76lorJwIIZEfektZdo6NbQgixhBcK3xA+jijdcg16Y1HQm5JlSIh66RJiRAy5Irai6iEVJSSkpLILsuktOPDXhC3ZGwups9kOghPdvSgjlmAUYkSYqmw4/P3pzqENyCt1P8ntNvyTkh1GUZLd8hn8RQygowl7mK8hIwoI4ToWdYouDU4DyGzpMPlcyohMCQEhoTAkBAYHkLCN+RGwishkrIRzy7LpEhMJxFjSBMjOU8QNajbIkrbKU8QIUQiOvAWIhmdRHVZI+IyJnoKUTo2oIRsw23G6Pk79eoJSZmmKyEwPIVoIbgB74RISicRXZZJseMV9/P2Ct7aINIaUsa9vUZvoZcV1HOunbenrHCyhCy5dxFrldMrxHjmnFQRDYqQHrYIKYOmvTAkBIaEwJAQGBICo5qQclPCXpQQGBICo5KQ4bsrQwmBISEwJASGhMCoImSKAd1QQmBICAwJgVFByJ7xo9zYo4TAoAuZZnbVUEJgzCCkVMrIQqbrroxZuqwycqlCPCqwxH9Epd656HVR+DsZiQnxbCH4rosmJKLC0FJIQiIryspCiplllnUPnBSKkMyKQUkhCCFUiF0DQszsXdaSdDHZQhCtcoU0MUrIY8KlSMgttpq/PEIhbJ1kXwBqO4WQkNYSI74ozMpo5bUDBXVz0XZm93w9klX819/TWlT8O/Wh0aAOQ0JgSAgMCYEhITAkBIaEwJAQFIfDN2Shgz9c4BjXAAAAAElFTkSuQmCC"}}]},iconsets:{default:[{display:"House",texId:"default_house",color:0,pHex:80,base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAMOSURBVHhe7ZpdbtQwFIUTQEVF8ECXUzbDDlhHt9InNsFaWAJCQppeo7GUTmfyY1/b59jnk65S5aWJP5/reJL5dDpNAod356MAQULA6ElI6L30/bcXIUsRj+cjJT0s6tduYD4f6WBOSBct6hJWIVsiaNsWY8vae8GUbYstIUdmD2VKmBKScqF0KWFJSOqsoZltkV72Id3AICR3llOlBF0IXcvJZZSWRSMWWchw6QiMtKhTCEYVUmrw4KUgChmyVUVGalkRaOFoQmoNFqwUJCG1BwlSCoqQVoMD94swgpCWM/WXFZSU1kIQ2gaUlJZCkHo4jJRWQhAXVAgpLd4YIsq4pNmbxtoJYZARaHadNYWwyIg0ud5aQthkRKpfd2khYZFklRGputCXXtTZZSypstCXTEhPMgJVklJKSG8yAlX2KSVaVo8ylhRtXd4Jab7TrUDRCecpJMgIsR6BYlK8hIwkoyhea0jv68Yt3NcTj4SMKiPgfu+lHntHwlVKrpCR07HEbRxyhEjGa1zGI1XICPuNJqQ+ZSkdt8l68kpJiNKxTtZkTUmI0rGPpKQcTYhk7CdprHIfe8U6h6UcEaJ0VGCvEMlI59DYqWWBsUeI0pHP7jHcEqI9R2W29iFKhy+be5O1hCgd/mxO8LWEKB3luJkUPWW14eZkl5B2XJVy5MdFtbAyvGpfqe9DrjG6sKz3IBHPluVyQaPjvYaMKsXtvrWogyEhYEgIGBIChoSAISFgSAgYEgKGhIAhIWBICBgSAoaEgCEhYEgIGBIChoSAISFgSAgY7ELCu+xY38KJBrh+R+D5GVCkxudAW4NQ85MkVyG9tqyWicmCMSFHZyTa9azClpCUm3cdsNLoKQsMJiE5M50mJUoIGBKSj+tDA4sQqoU5h5ESQiGVQchpnudpWT3DsDH8YxI+nf/Owu615CbRZaaUEHJJ7j/4bfXD6qfVP6s7qwerD1ZB1Eerz1ZfrULi703gsx3fICEOHG1Rdj9BUJD2/v+Jafpr9cXqyep7OOGIe/+EFxLwWjfw73WaXgA0M6p+MsbyoAAAAABJRU5ErkJggg=="},{display:"Red Pillar",texId:"default_pillar",color:16711680,pHex:80,base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJeSURBVHhe7ZxhToNAGERbj6UX6JF7Ab1WZc2SoGkJW8vyZnZe0hT+KM3zm1kocr7dbqfA4a2+BwgRAiNCYEQIjAiBoSKkLAWHWA6qTYi9lEQWjAiBoSjEOrYUhAx1bSeRBUNViO3UyAm5Xq91y5NEFgy6kIfRNE3Ke920gv4F1a+DW8bV5XIpb+efHSMSWTAiBIa0EMceke2QgmOPJLJgkIWsTocrmRAYDkLQJdiK+iqrbvmQyIJhIcTpfIR8HrJ5leV0PkKdEKuibiEdAsNJiMVUuZR63dKHKGTY/iikQ2C4CZGfLhshLj2SyIJhJ0T9Mgrt0snDg9kaSeqXURJZMCIEBknIK7NTdvnrWOp1S5NEFowIgUERskfmS/aI5YQo90giCwZBiOwSdQ/cJ0ROtq0Q1R45WojlP27+h6OFfNb3UHHvEDmOFNKrcKWK3XpCFIs9kQXjKCE5GXxAJgTGKEJkJtJeiFqxHyEk/bFCOgRGhMDoLeTpuKp3JP4HiagcYkKUij2RBSNCYPQUkuXuBkabEPwfxTBCVIo9HQKjl5DczLCRXkJecjPDC04O8YwYWehiH0qIQrH3EJL+aKCHkNwM18CIHYJmVCHYYt9bCO6D04s9kQUjQmCMLATZI3sKwRYnuUcSWTCGFEK+SLnnA8x2+cHPxs2KBNTDzuyF/BGBf9LcnpFVPvz86k4RUV6TwI9p97DjaOWoZy4+/UvXJmQ5DUXEtP9Vd2UgPASz6QDuCVGLpTVknko6sxTiJGKGJmSm5aAsRMxQhSy5d4BWEpYoCBmKXDqBESEoTqdvi9ml8cBIeugAAAAASUVORK5CYII="},{display:"Green Pillar",texId:"default_pillar",color:65280,pHex:80,base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJeSURBVHhe7ZxhToNAGERbj6UX6JF7Ab1WZc2SoGkJW8vyZnZe0hT+KM3zm1kocr7dbqfA4a2+BwgRAiNCYEQIjAiBoSKkLAWHWA6qTYi9lEQWjAiBoSjEOrYUhAx1bSeRBUNViO3UyAm5Xq91y5NEFgy6kIfRNE3Ke920gv4F1a+DW8bV5XIpb+efHSMSWTAiBIa0EMceke2QgmOPJLJgkIWsTocrmRAYDkLQJdiK+iqrbvmQyIJhIcTpfIR8HrJ5leV0PkKdEKuibiEdAsNJiMVUuZR63dKHKGTY/iikQ2C4CZGfLhshLj2SyIJhJ0T9Mgrt0snDg9kaSeqXURJZMCIEBknIK7NTdvnrWOp1S5NEFowIgUERskfmS/aI5YQo90giCwZBiOwSdQ/cJ0ROtq0Q1R45WojlP27+h6OFfNb3UHHvEDmOFNKrcKWK3XpCFIs9kQXjKCE5GXxAJgTGKEJkJtJeiFqxHyEk/bFCOgRGhMDoLeTpuKp3JP4HiagcYkKUij2RBSNCYPQUkuXuBkabEPwfxTBCVIo9HQKjl5DczLCRXkJecjPDC04O8YwYWehiH0qIQrH3EJL+aKCHkNwM18CIHYJmVCHYYt9bCO6D04s9kQUjQmCMLATZI3sKwRYnuUcSWTCGFEK+SLnnA8x2+cHPxs2KBNTDzuyF/BGBf9LcnpFVPvz86k4RUV6TwI9p97DjaOWoZy4+/UvXJmQ5DUXEtP9Vd2UgPASz6QDuCVGLpTVknko6sxTiJGKGJmSm5aAsRMxQhSy5d4BWEpYoCBmKXDqBESEoTqdvi9ml8cBIeugAAAAASUVORK5CYII="}]},paths:[],icons:[],texts:[]},Se=10;for(let l=-Se;l<=Se;l++)for(let e=-Se;e<=Se;e++)-l-e>=-Se&&-l-e<=Se&&(Ze.TerrainField.hexes[Ve(l,e,-l-e)]={q:l,r:e,s:-l-e,bgColor:15921906,symbolId:null,symbol:null});function Un(l){let e,t;return e=new yn({}),e.$on("appstatechange",l[56]),{c(){F(e.$$.fragment)},m(n,o){N(e,n,o),t=!0},p:le,i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Pn(l){let e,t,n=!l[6]&&Wt(l);return{c(){n&&n.c(),e=he()},m(o,r){n&&n.m(o,r),Y(o,e,r),t=!0},p(o,r){o[6]?n&&(ce(),K(n,1,1,()=>{n=null}),de()):n?(n.p(o,r),r[0]&64&&R(n,1)):(n=Wt(o),n.c(),R(n,1),n.m(e.parentNode,e))},i(o){t||(R(n),t=!0)},o(o){K(n),t=!1},d(o){n&&n.d(o),o&&D(e)}}}function Wt(l){let e,t,n,o,r,i,a,s,u,c,h,k,b,E,g,m,d,f,y,H,T,v;t=new Vt({props:{app:l[21],$$slots:{default:[Rn]},$$scope:{ctx:l}}});const w=[Yn,Jn,Ln,Mn],I=[];function U(_,L){return _[12]=="terrain"?0:_[12]=="icon"?1:_[12]=="path"?2:_[12]=="text"?3:-1}~(o=U(l))&&(r=I[o]=w[o](l));function P(_){l[49](_)}let O={};l[12]!==void 0&&(O.selectedTool=l[12]),s=new cn({props:O}),V.push(()=>j(s,"selectedTool",P));let M=l[17]&&Ot(l),A=l[18]&&xt(l);return{c(){e=S("main"),F(t.$$.fragment),n=Q(),r&&r.c(),i=Q(),a=S("div"),F(s.$$.fragment),c=Q(),h=S("div"),k=S("button"),k.innerHTML='<img src="assets/img/tools/save.png" alt="Save"/>',b=Q(),E=S("button"),E.innerHTML='<img src="assets/img/tools/maps.png" alt="Maps"/>',g=Q(),m=S("button"),m.innerHTML='<img src="assets/img/tools/settings.png" alt="Map Settings"/>',d=Q(),M&&M.c(),f=Q(),A&&A.c(),y=he(),C(e,"class","svelte-1c5rcxj"),C(a,"id","tool-buttons"),C(a,"class","svelte-1c5rcxj"),C(k,"class","svelte-1c5rcxj"),C(E,"class","svelte-1c5rcxj"),C(m,"class","svelte-1c5rcxj"),C(h,"id","setting-buttons"),C(h,"class","svelte-1c5rcxj")},m(_,L){Y(_,e,L),N(t,e,null),Y(_,n,L),~o&&I[o].m(_,L),Y(_,i,L),Y(_,a,L),N(s,a,null),Y(_,c,L),Y(_,h,L),p(h,k),p(h,b),p(h,E),p(h,g),p(h,m),Y(_,d,L),M&&M.m(_,L),Y(_,f,L),A&&A.m(_,L),Y(_,y,L),H=!0,T||(v=[J(e,"contextmenu",Il(Wn)),J(e,"mousewheel",l[41]),J(e,"pointerdown",l[42]),J(e,"pointermove",l[43]),J(e,"pointerup",l[44]),J(k,"click",l[27]),J(E,"click",l[50]),J(m,"click",l[51])],T=!0)},p(_,L){const G={};L[0]&130621|L[1]&268435456&&(G.$$scope={dirty:L,ctx:_}),t.$set(G);let W=o;o=U(_),o===W?~o&&I[o].p(_,L):(r&&(ce(),K(I[W],1,1,()=>{I[W]=null}),de()),~o?(r=I[o],r?r.p(_,L):(r=I[o]=w[o](_),r.c()),R(r,1),r.m(i.parentNode,i)):r=null);const Z={};!u&&L[0]&4096&&(u=!0,Z.selectedTool=_[12],z(()=>u=!1)),s.$set(Z),_[17]?M?(M.p(_,L),L[0]&131072&&R(M,1)):(M=Ot(_),M.c(),R(M,1),M.m(f.parentNode,f)):M&&(ce(),K(M,1,1,()=>{M=null}),de()),_[18]?A?(A.p(_,L),L[0]&262144&&R(A,1)):(A=xt(_),A.c(),R(A,1),A.m(y.parentNode,y)):A&&(ce(),K(A,1,1,()=>{A=null}),de())},i(_){H||(R(t.$$.fragment,_),R(r),R(s.$$.fragment,_),R(M),R(A),H=!0)},o(_){K(t.$$.fragment,_),K(r),K(s.$$.fragment,_),K(M),K(A),H=!1},d(_){_&&D(e),X(t),_&&D(n),~o&&I[o].d(_),_&&D(i),_&&D(a),X(s),_&&D(c),_&&D(h),_&&D(d),M&&M.d(_),_&&D(f),A&&A.d(_),_&&D(y),T=!1,_e(v)}}}function Qn(l){let e,t,n,o,r,i,a,s,u,c,h,k,b,E,g,m;function d(A){l[30](A)}function f(A){l[31](A)}let y={pan:l[10],controls:l[11],L:l[22]};l[13]!==void 0&&(y.data_terrain=l[13]),l[0].TerrainField!==void 0&&(y.tfield=l[0].TerrainField),e=new Rl({props:y}),l[29](e),V.push(()=>j(e,"data_terrain",d)),V.push(()=>j(e,"tfield",f));function H(A){l[33](A)}function T(A){l[34](A)}let v={pan:l[10],controls:l[11],selectedTool:l[12],tfield:l[9]};l[0].paths!==void 0&&(v.paths=l[0].paths),l[15]!==void 0&&(v.data_path=l[15]),r=new Wl({props:v}),l[32](r),V.push(()=>j(r,"paths",H)),V.push(()=>j(r,"data_path",T));function w(A){l[36](A)}function I(A){l[37](A)}let U={L:l[22],pan:l[10],selectedTool:l[12],tfield:l[9],controls:l[11]};l[0].icons!==void 0&&(U.icons=l[0].icons),l[14]!==void 0&&(U.data_icon=l[14]),u=new Jl({props:U}),l[35](u),V.push(()=>j(u,"icons",w)),V.push(()=>j(u,"data_icon",I));function P(A){l[39](A)}function O(A){l[40](A)}let M={pan:l[10]};return l[0].texts!==void 0&&(M.texts=l[0].texts),l[16]!==void 0&&(M.data_text=l[16]),b=new Fl({props:M}),l[38](b),V.push(()=>j(b,"texts",P)),V.push(()=>j(b,"data_text",O)),{c(){F(e.$$.fragment),o=Q(),F(r.$$.fragment),s=Q(),F(u.$$.fragment),k=Q(),F(b.$$.fragment)},m(A,_){N(e,A,_),Y(A,o,_),N(r,A,_),Y(A,s,_),N(u,A,_),Y(A,k,_),N(b,A,_),m=!0},p(A,_){const L={};_[0]&1024&&(L.pan=A[10]),_[0]&2048&&(L.controls=A[11]),!t&&_[0]&8192&&(t=!0,L.data_terrain=A[13],z(()=>t=!1)),!n&&_[0]&1&&(n=!0,L.tfield=A[0].TerrainField,z(()=>n=!1)),e.$set(L);const G={};_[0]&1024&&(G.pan=A[10]),_[0]&2048&&(G.controls=A[11]),_[0]&4096&&(G.selectedTool=A[12]),_[0]&512&&(G.tfield=A[9]),!i&&_[0]&1&&(i=!0,G.paths=A[0].paths,z(()=>i=!1)),!a&&_[0]&32768&&(a=!0,G.data_path=A[15],z(()=>a=!1)),r.$set(G);const W={};_[0]&1024&&(W.pan=A[10]),_[0]&4096&&(W.selectedTool=A[12]),_[0]&512&&(W.tfield=A[9]),_[0]&2048&&(W.controls=A[11]),!c&&_[0]&1&&(c=!0,W.icons=A[0].icons,z(()=>c=!1)),!h&&_[0]&16384&&(h=!0,W.data_icon=A[14],z(()=>h=!1)),u.$set(W);const Z={};_[0]&1024&&(Z.pan=A[10]),!E&&_[0]&1&&(E=!0,Z.texts=A[0].texts,z(()=>E=!1)),!g&&_[0]&65536&&(g=!0,Z.data_text=A[16],z(()=>g=!1)),b.$set(Z)},i(A){m||(R(e.$$.fragment,A),R(r.$$.fragment,A),R(u.$$.fragment,A),R(b.$$.fragment,A),m=!0)},o(A){K(e.$$.fragment,A),K(r.$$.fragment,A),K(u.$$.fragment,A),K(b.$$.fragment,A),m=!1},d(A){l[29](null),X(e,A),A&&D(o),l[32](null),X(r,A),A&&D(s),l[35](null),X(u,A),A&&D(k),l[38](null),X(b,A)}}}function Rn(l){let e,t;return e=new je({props:{instance:l[20],x:l[10].offsetX,y:l[10].offsetY,scale:{x:l[10].zoomScale,y:l[10].zoomScale},$$slots:{default:[Qn]},$$scope:{ctx:l}}}),{c(){F(e.$$.fragment)},m(n,o){N(e,n,o),t=!0},p(n,o){const r={};o[0]&1024&&(r.x=n[10].offsetX),o[0]&1024&&(r.y=n[10].offsetY),o[0]&1024&&(r.scale={x:n[10].zoomScale,y:n[10].zoomScale}),o[0]&130621|o[1]&268435456&&(r.$$scope={dirty:o,ctx:n}),e.$set(r)},i(n){t||(R(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Mn(l){let e,t,n;function o(i){l[48](i)}let r={comp_textLayer:l[5]};return l[16]!==void 0&&(r.data_text=l[16]),e=new an({props:r}),V.push(()=>j(e,"data_text",o)),{c(){F(e.$$.fragment)},m(i,a){N(e,i,a),n=!0},p(i,a){const s={};a[0]&32&&(s.comp_textLayer=i[5]),!t&&a[0]&65536&&(t=!0,s.data_text=i[16],z(()=>t=!1)),e.$set(s)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){X(e,i)}}}function Ln(l){let e,t,n;function o(i){l[47](i)}let r={comp_pathLayer:l[4]};return l[15]!==void 0&&(r.data_path=l[15]),e=new nn({props:r}),V.push(()=>j(e,"data_path",o)),{c(){F(e.$$.fragment)},m(i,a){N(e,i,a),n=!0},p(i,a){const s={};a[0]&16&&(s.comp_pathLayer=i[4]),!t&&a[0]&32768&&(t=!0,s.data_path=i[15],z(()=>t=!1)),e.$set(s)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){X(e,i)}}}function Jn(l){let e,t,n;function o(i){l[46](i)}let r={L:l[22],app:l[21],loadedIconsets:l[8]};return l[14]!==void 0&&(r.data_icon=l[14]),e=new en({props:r}),V.push(()=>j(e,"data_icon",o)),{c(){F(e.$$.fragment)},m(i,a){N(e,i,a),n=!0},p(i,a){const s={};a[0]&256&&(s.loadedIconsets=i[8]),!t&&a[0]&16384&&(t=!0,s.data_icon=i[14],z(()=>t=!1)),e.$set(s)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){X(e,i)}}}function Yn(l){let e,t,n;function o(i){l[45](i)}let r={loadedTilesets:l[7],tfield:l[9],app:l[21],L:l[22]};return l[13]!==void 0&&(r.data_terrain=l[13]),e=new jl({props:r}),V.push(()=>j(e,"data_terrain",o)),{c(){F(e.$$.fragment)},m(i,a){N(e,i,a),n=!0},p(i,a){const s={};a[0]&128&&(s.loadedTilesets=i[7]),a[0]&512&&(s.tfield=i[9]),!t&&a[0]&8192&&(t=!0,s.data_terrain=i[13],z(()=>t=!1)),e.$set(s)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){X(e,i)}}}function Ot(l){let e,t,n;function o(i){l[52](i)}let r={load:l[28]};return l[17]!==void 0&&(r.showSavedMaps=l[17]),e=new wn({props:r}),V.push(()=>j(e,"showSavedMaps",o)),{c(){F(e.$$.fragment)},m(i,a){N(e,i,a),n=!0},p(i,a){const s={};!t&&a[0]&131072&&(t=!0,s.showSavedMaps=i[17],z(()=>t=!1)),e.$set(s)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){X(e,i)}}}function xt(l){let e,t,n;function o(i){l[55](i)}let r={loadedSave:l[0],tfield:l[9],save:l[27],renderAllHexes:l[2].renderAllHexes,$$slots:{default:[Dn]},$$scope:{ctx:l}};return l[18]!==void 0&&(r.showSettings=l[18]),e=new Sn({props:r}),V.push(()=>j(e,"showSettings",o)),{c(){F(e.$$.fragment)},m(i,a){N(e,i,a),n=!0},p(i,a){const s={};a[0]&1&&(s.loadedSave=i[0]),a[0]&512&&(s.tfield=i[9]),a[0]&4&&(s.renderAllHexes=i[2].renderAllHexes),a[0]&2|a[1]&268435456&&(s.$$scope={dirty:a,ctx:i}),!t&&a[0]&262144&&(t=!0,s.showSettings=i[18],z(()=>t=!1)),e.$set(s)},i(i){n||(R(e.$$.fragment,i),n=!0)},o(i){K(e.$$.fragment,i),n=!1},d(i){X(e,i)}}}function Dn(l){let e,t,n,o,r;return{c(){e=S("button"),e.textContent="Generate Terrain",t=Q(),n=S("button"),n.textContent="Tileset Builder (WIP, BROKEN FOR REAL)"},m(i,a){Y(i,e,a),Y(i,t,a),Y(i,n,a),o||(r=[J(e,"click",l[53]),J(n,"click",l[54])],o=!0)},p:le,d(i){i&&D(e),i&&D(t),i&&D(n),o=!1,_e(r)}}}function Kn(l){let e,t,n,o;const r=[Pn,Un],i=[];function a(s,u){return s[1]=="normal"?0:s[1]=="tilesetCreator"?1:-1}return~(e=a(l))&&(t=i[e]=r[e](l)),{c(){t&&t.c(),n=he()},m(s,u){~e&&i[e].m(s,u),Y(s,n,u),o=!0},p(s,u){let c=e;e=a(s),e===c?~e&&i[e].p(s,u):(t&&(ce(),K(i[c],1,1,()=>{i[c]=null}),de()),~e?(t=i[e],t?t.p(s,u):(t=i[e]=r[e](s),t.c()),R(t,1),t.m(n.parentNode,n)):t=null)},i(s){o||(R(t),o=!0)},o(s){K(t),o=!1},d(s){~e&&i[e].d(s),s&&D(n)}}}const Wn=l=>{};function On(l,e,t){let n=Ze,o=null,r="normal";function i(B){t(1,r=B.detail.newState)}let a=new ze,s,u,c,h,k=new Xt({backgroundAlpha:0,width:window.innerWidth,height:window.innerHeight,resizeTo:window}),b=!0,E,g,m,d={panning:!1,oldX:0,oldY:0,offsetX:window.innerWidth/2,offsetY:window.innerHeight/2,screenX:0,screenY:0,zoomScale:1,get worldX(){return(d.screenX-d.offsetX)/d.zoomScale},get worldY(){return(d.screenY-d.offsetY)/d.zoomScale},startPan(B){t(10,d.panning=!0,d),t(10,d.oldX=B.clientX,d),t(10,d.oldY=B.clientY,d)},handle(B){t(10,d.screenX=B.clientX,d),t(10,d.screenY=B.clientY,d),d.panning&&(t(10,d.offsetX+=B.clientX-d.oldX,d),t(10,d.offsetY+=B.clientY-d.oldY,d),t(10,d.oldX=B.clientX,d),t(10,d.oldY=B.clientY,d))},endPan(){t(10,d.panning=!1,d)},zoom(B){let be=d.worldX,ge=d.worldY,Te=1.15;B.deltaY<0?t(10,d.zoomScale*=Te,d):t(10,d.zoomScale/=Te,d);let Ee=d.worldX,Je=d.worldY,Be=(Ee-be)*d.zoomScale,Fe=(Je-ge)*d.zoomScale;t(10,d.offsetX+=Be,d),t(10,d.offsetY+=Fe,d)}},f={mouseDown:[!1,!1,!1,!1,!1]},y="terrain",H={bgColor:null,symbolData:null},T={color:null,texId:null,pHex:80,snapToHex:!0},v={style:{color:0,width:3,cap:"round",join:"round"},colorString:"#000000",selectedPath:null,snap:!1,editorRef:null},w={style:{fontFamily:"Segoe UI",fill:"#000000",fontSize:25,miterLimit:2,strokeThickness:0,stroke:"#f2f2f2"},selectedText:null};const I=new qt;async function U(B,be){t(7,E=B.tilesets),t(8,g=B.iconsets),t(9,m=B.TerrainField);let ge=[];for(let Be in E)E[Be].forEach(ae=>{ae.symbol&&ge.find(Ne=>ae.symbol.texId==Ne)==null&&!I.resources[ae.symbol.texId]&&(I.add(ae.symbol.texId,ae.symbol.base64),ge.push(ae.symbol.texId))});let Te=[];for(let Be in g)g[Be].forEach(ae=>{Te.find(Ne=>ae.texId==Ne)==null&&!I.resources[ae.texId]&&(I.add(ae.texId,ae.base64),Te.push(ae.texId))});I.onLoad.add(()=>{t(6,b=!1)}),I.load();let Ee=E[Object.keys(E)[0]][0];t(13,H.bgColor=Ee.bgColor,H),t(13,H.symbolData=Ee.symbol?ue({},Ee.symbol):null,H);let Je=g[Object.keys(g)[0]][0];t(14,T.color=Je.color,T),t(14,T.texId=Je.texId,T),t(0,n=B),o=be}U(Ze,null);function P(B){switch(t(11,f.mouseDown[B.button]=!0,f),f.mouseDown[2]&&d.startPan(B),y){case"terrain":f.mouseDown[0]&&s.placeTerrain();break;case"icon":f.mouseDown[0]&&u.newIcon();break;case"path":f.mouseDown[0]&&c.pointerdown();break;case"text":f.mouseDown[0]&&h.pointerdown();break;case"eraser":f.mouseDown[0]&&s.erase();break}}function O(B){switch(t(11,f.mouseDown[B.button]=!1,f),f.mouseDown[2]||d.endPan(),y){case"text":h.pointerup();break}}function M(B){switch(d.handle(B),y){case"terrain":f.mouseDown[0]&&s.placeTerrain();break;case"text":h.pointermove();break;case"eraser":f.mouseDown[0]&&s.erase();break}}let A=!1,_=!1;function L(){Bn(m,E.default),s.renderAllHexes()}async function G(){if(n.title==""){let ge=prompt("Map Title:");if(ge!=null)t(0,n.title=ge,n);else{alert("Cancelled save");return}}let B=JSON.stringify(n),be=k.renderer.plugins.extract.base64(a);if(o)await We.mapSaves.update(o,{mapString:B,previewBase64:be}),console.log(`Updated saved map with id ${o}`);else{const ge=await We.mapSaves.add({mapString:B,previewBase64:be});console.log(`Added map with id ${ge}`),o=ge}alert("Saved")}async function W(B,be){console.log(`Loaded ${be}`),U(B,be),t(6,b=!0),t(15,v.selectedPath=null,v),t(16,w.selectedText=null,w),await Sl(),t(6,b=!1)}function Z(B){V[B?"unshift":"push"](()=>{s=B,t(2,s)})}function Ae(B){H=B,t(13,H)}function $(B){l.$$.not_equal(n.TerrainField,B)&&(n.TerrainField=B,t(0,n))}function ye(B){V[B?"unshift":"push"](()=>{c=B,t(4,c)})}function ee(B){l.$$.not_equal(n.paths,B)&&(n.paths=B,t(0,n))}function x(B){v=B,t(15,v)}function se(B){V[B?"unshift":"push"](()=>{u=B,t(3,u)})}function ke(B){l.$$.not_equal(n.icons,B)&&(n.icons=B,t(0,n))}function Me(B){T=B,t(14,T)}function re(B){V[B?"unshift":"push"](()=>{h=B,t(5,h)})}function Le(B){l.$$.not_equal(n.texts,B)&&(n.texts=B,t(0,n))}function Gt(B){w=B,t(16,w)}const Zt=B=>{d.zoom(B)},jt=B=>{P(B)},zt=B=>{M(B)},$t=B=>{O(B)};function el(B){H=B,t(13,H)}function tl(B){T=B,t(14,T)}function ll(B){v=B,t(15,v)}function nl(B){w=B,t(16,w)}function ol(B){y=B,t(12,y)}const il=()=>{t(17,A=!0)},sl=()=>{t(18,_=!0)};function rl(B){A=B,t(17,A)}const al=()=>{L()},ul=()=>{t(1,r="tilesetCreator")};function fl(B){_=B,t(18,_)}return[n,r,s,u,c,h,b,E,g,m,d,f,y,H,T,v,w,A,_,i,a,k,I,P,O,M,L,G,W,Z,Ae,$,ye,ee,x,se,ke,Me,re,Le,Gt,Zt,jt,zt,$t,el,tl,ll,nl,ol,il,sl,rl,al,ul,fl,B=>i(B)]}class xn extends ne{constructor(e){super();oe(this,e,On,Kn,ie,{},null,[-1,-1])}}new xn({target:document.getElementById("app")});
