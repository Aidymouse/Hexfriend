<!DOCTYPE html>

<html>

    <head>
        <meta charset="utf-8">
        <script src="https://unpkg.com/dexie/dist/dexie.js"></script>

        <script src="js/lib/jquery-3.5.1.min.js"></script>
        <script src="js/lib/pixi.min.js"></script>

        <script src="js/helpers/cssHelpers.js"></script>
        <script src="js/helpers/pixiHelpers.js"></script>
        <script src="js/helpers/hexHelpers.js"></script>

        <script src="js/defaultSaveData.js"></script>
        <script src="js/export.js"></script>
        
        <script src="js/mapSettings.js"></script>
        <script src="js/tooldata.js"></script>

        <script src="js/iconLayer.js"></script>
        <script src="js/pathLayer.js"></script>
        <script src="js/textLayer.js"></script>
        <script src="js/Hexfield.js"></script>

        <script src="js/selectors/HexMatrixSelector.js"></script>
        <script src="js/selectors/TerrainSelector.js"></script>
        <script src="js/selectors/IconSelector.js"></script>
        <script src="js/selectors/TextStyleSelector.js"></script>

        <script src="js/tilesetCreator.js"></script>

        <script src="js/undoManager.js"></script>

        <script src="main.js"></script>

        <!-- Stylesheets -->
        <link rel="stylesheet" type="text/css" href="css/toolbar.css">
        <link rel="stylesheet" type="text/css" href="css/panels.css">
        <link rel="stylesheet" type="text/css" href="css/maps.css">
        <link rel="stylesheet" type="text/css" href="css/mapSettings.css">
        <link rel="stylesheet" type="text/css" href="css/controls.css">
        <link rel="stylesheet" type="text/css" href="css/tilesetCreator.css">
        <link rel="stylesheet" type="text/css" href="main.css">
        
        <link rel="icon" type="image/png" href="./assets/img/site/hexfriend.png">


        <title>Hexfriend</title>
    </head>

    <body>

        <div id="tools">
            <!-- Note, it's important that the id of the button is the same as the changeTool id, but with the suffix 'btn_' -->
            <button class="toolButton selectedTool" id="btn_terrain" onclick="changeTool('terrain'); updateToolButton('btn_terrain'); updateToolPanel('pnl_terrain'); updateShownControls('controls_terrain')"><img src="./assets/img/tools/Terrain.png"></button>
            <button class="toolButton" id="btn_icon" onclick="changeTool('icon'); updateToolButton('btn_icon'); updateToolPanel('pnl_icons'); updateShownControls('controls_icon')"><img src="./assets/img/tools/Icon.png"></button>
            <button class="toolButton" id="btn_path" onclick="changeTool('path'); updateToolButton('btn_path'); updateToolPanel('pnl_path'); updateShownControls('controls_path-none-selected')"><img src="./assets/img/tools/Path.png"></button>
            <button class="toolButton" id="btn_text" onclick="changeTool('text'); updateToolButton('btn_text'); updateToolPanel('pnl_text'); updateShownControls('controls_text-none-selected')"><img src="./assets/img/tools/Text.png"></button>
            <button class="toolButton" id="btn_eraser" onclick="changeTool('eraser'); updateToolButton('btn_eraser'); updateToolPanel(null); updateShownControls('controls_eraser')"><img src="./assets/img/tools/Eraser.png"></button>
            
        </div>
        
        <div id="settings">
            <div id="save-options">

               
                <button class="toolButton hidden-save-option" id="btn_export" style="height: 25px" onclick="exportToPng()">Export</button>
                
                
                <button class="toolButton" id="btn_save"><img src="./assets/img/tools/Save.png"></button>
            </div>
            <button class="toolButton" onclick="loadSavedMaps(); showMaps()"><img src="./assets/img/tools/Maps.png"></button>
            <button class="toolButton" onclick="showMapSettings()"><img src="./assets/img/tools/Settings.png"></button>    
        </div>

        <div id="panels">
            <!-- The terrain and Icon panels are replaced in code with selectors -->
            <div id="pnl_terrain" class="tool-panel shown-panel">
                <div id="current-terrain">

                    <img id="current-terrain-preview">

                    <div class="row"> 
                        <div class="circle-color-input-wrapper" id="w-terrain-preview-bgColor"> 
                            <input type="color" id="terrain-preview-bgColor" onchange="primaryToolData.terrainPreview_changeBgColor()"> 
                        </div> 
                        Background
                    </div>
                    
                    

                    <div id="terrain-preview-symbol-container" class="row hidden">
                        <div class="circle-color-input-wrapper" id="w-terrain-preview-symbolColor">
                            <input type="color" id="terrain-preview-symbolColor" onchange="primaryToolData.terrainPreview_changeSymbolColor()">
                        </div>
                        Symbol
                    </div>

                </div>

                <hr>

                <div id="pnl_terrainButtons"></div>
            </div>
            
            <div id="pnl_icons" class="tool-panel">
                <div id="current-icon">
                
                    <img id="current-icon-preview">
                
                    <div class="row">
                        <div class="circle-color-input-wrapper" id="w-icon-preview-color">
                            <input type="color" id="icon-preview-color" onchange="primaryToolData.iconPreview_changeColor()">
                        </div>
                        Color
                    </div>
                
                    <div class="row"> Snap to Hex <input type="checkbox" id="cb_iconSnap" checked="true"> </div>
                
                
                
                </div>

                <hr>

                <div id="pnl_iconButtons">
                </div>
            </div>

            <div id="pnl_path" class="tool-panel">
                <input type="color" id="pathStroke" onchange="primaryPathLayer.updateSelectedPathStyleFromHTML()">
                <input type="number" value="5" id="pathStrokeThickness" onchange="primaryPathLayer.updateSelectedPathStyleFromHTML()">
                <hr>
                <div id="path-selected-only-controls" class="hidden">
                    <button onclick="primaryPathLayer.deselectPath()">Deselect Current Path</button>
                    <button onclick="primaryPathLayer.deletePath(primaryPathLayer.selectedPath)">Delete Path</button>
                    <button onclick="primaryPathLayer.removeLastSelectedPoint()">Remove Last Point</button>
                </div>
                <hr>
                <b>Saved Styles</b>
            </div>
            
            <div id="pnl_text" class="tool-panel">
                <input type="color" id="textColor" onchange="updateTextStyleFromHTML('fill', $('#textColor').val())">
                <input type="number" value="36" id="textSize" onchange="updateTextStyleFromHTML('fontSize', Number($('#textSize').val()))">
                <input type="color" id="textStroke" onchange="updateTextStyleFromHTML('stroke', $('#textStroke').val())">
                <input type="number" value="0" id="textStrokeThickness" onchange="updateTextStyleFromHTML('strokeThickness', Number($('#textStrokeThickness').val()))">
                <select id="text_font-family" onchange="updateTextStyleFromHTML('fontFamily', $('#text_font-family').val())">
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Arial">Arial</option>
                    <option value="Comic Sans MS">Comic Sans MS</option>
                </select>
                <!--<button>Save current style</button>-->
                <hr>
                <div id="text-selected-only-controls" class="hidden">
                    <button onclick="primaryTextLayer.deleteSelectedText()">Delete Selected Text</button>
                </div>
                <hr>
                <b>Text Styles</b>
                <div id="textstyle-selector"></div>
            </div>

        </div>

        <div id="controls">
            <!-- TERRAIN CONTROLS -->
            <div class="controls-listing" id="controls_terrain">
                Left Mouse: Paint Terrain<br>
            </div>


            <!-- ICON CONTROLS -->
            <div class="controls-listing hidden" id="controls_icon">
                Left Mouse: Place Icon<br>
            </div>
            

            <!-- PATH CONTROLS -->
            <div class="controls-listing hidden" id="controls_path-none-selected">
                Left Mouse: Start New Path<br>
            </div>
            
            <div class="controls-listing hidden" id="controls_path-only-hovered">
                Left Mouse: Select Path<br>
                Shift + Left Mouse: Start New Path
            </div>

            <div class="controls-listing hidden" id="controls_path-selected">
                Left Mouse: Place Point<br>
                XXX: Deselect Path<br>
                XXX: Delete Last Point<br>
                XXX: Delete Path<br>
            </div>


            <!-- TEXT CONTROLS -->
            <div class="controls-listing hidden" id="controls_text-none-selected">
                Left Mouse: New Text<br>
            </div>

            <div class="controls-listing hidden" id="controls_text-selected-same-hovered">
                Click and Drag: Move Text<br>
                Keyboard: Edit Text<br>
                Delete: Delete Selected Text
            </div>

            <div class="controls-listing hidden" id="controls_text-selected-and-hovered">
                Left Mouse: Select Text<br>
                Click and Drag: Select and Move Text<br>
                Keyboard: Edit Text<br>
                Delete: Delete Selected Text
            </div>

            <div class="controls-listing hidden" id="controls_text-only-selected">
                Left Mouse: Deselect Text<br>
                Keyboard: Edit Text<br>
                Delete: Delete Selected Text
            </div>

            <div class="controls-listing hidden" id="controls_text-only-hovered">
                Left Mouse: Select Text<br>
                Click and Drag: Move Text
            </div>


            
            
            <!-- ERASER CONTROLS -->
            <div class="controls-listing hidden" id="controls_eraser">
                Left Mouse: Erase Icons and Terrain<br>
            </div>

            Right Mouse: Pan Canvas<br>
            Mouse Wheel: Zoom
        </div>

        <!-- Pixi inserts the application part of the application here -->
        <div id="app-canvas">
        </div>


        <!-- Windows that aren't shown all the time -->
        <div id="maps" class="hidden">
            
            <div class="close-clicker" onclick="hideMaps()"></div>

            <div id="mapsMenu">
                <div id="loadedMaps">Loading...</div>
                
                <button id="closeButton" onclick="hideMaps()">X</button>
                <button id="newButton" onclick="newMap()">New Map</button>

            </div>

        </div>
        
        <div id="map-settings-container" class="hidden">

            <div class="close-clicker" onclick="hideMapSettings()"></div>

            <div id="map-settings">
                <button id="closeButton" onclick="hideMapSettings()">X</button>

                Map Title: <input type="text" id="setting_map-title"><br>
                <hr>
                Hexes are: <select id="setting_hex-orientation" onchange="setting_updateOrientation()">
                    <option value="flatTop">flat topped</option>
                    <option value="pointyTop">pointy topped</option>
                </select>(changing this rotates your map 1 face clockwise)<br>

                Hex width: <input type="number" id="setting_hex-width" onchange="setting_resizeHexes()"><br>
                Hex height: <input type="number" id="setting_hex-height" onchange="setting_resizeHexes()"><br>
                
                Grid: <input type="checkbox" id="setting_hexgrid-visible" onchange="setting_changeHexgridVisibility()">
                Grid Thickness: <input type="number" id="setting_hexgrid-thickness" onchange="setting_changeHexgridThickness()"> <!-- Will want to hide this if grid isnt shown -->
                Grid Color: <input type="color" id="setting_hexgrid-stroke" onchange="setting_changeHexgridStroke()">

                Blank Hex Color: <input type="color" id="setting_blank-hex-color" onchange="setting_changeBlankHexColor()">

                <hr>
                <b>Tilesets</b><br>
                Currently Loaded: Default<br>
                Installed but not loaded: —<br>

                <button onclick="openTilesetCreator()">Open Tileset Creator</button>

            </div>
        </div>

        <!-- A whole other bloody web app -->
        <div id="tileset-creator" class="hidden">

            <div id="side-panel">
                <div id="tileset-settings"></div>
                <div id="hex-buttons">
                    <button class="hex-button" id="new-tile" onclick="createNewTile()">+</button>
                </div>
            </div>

            <div id="hex-preview">
                <div id="pixi-hex-preview"></div>
            
                <input type="text" id="previewed-hex-name" onchange="updatePreviewedName()">
            </div>

            <div id="current-hex-controls">

                <div class="hex-property-selector">
                    <input type="color" id="hex-background" onchange="bgColorUpdated()">

                    <div class="hex-property-label" id="label-bgColor">
                        Background Color<br>
                        #000000
                    </div>

                </div>
                
                <input type="file" id="symbol-image">

                <div class="hex-property-selector">
                    <input type="color" id="symbol-color">
                
                    <div class="hex-property-label">
                        Symbol Color<br>
                        #000000
                    </div>
                
                </div>
            </div>

            
            
            

            <button id="exit-tilecreator" onclick="hideTilesetCreator()">Exit</button>

        </div>

    </body>
        



</html>